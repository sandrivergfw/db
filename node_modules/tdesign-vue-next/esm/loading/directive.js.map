{"version":3,"file":"directive.js","sources":["../../src/loading/directive.ts"],"sourcesContent":["import type { Directive, DirectiveBinding } from 'vue';\nimport { TdLoadingProps } from './type';\nimport produceLoading from './plugin';\n\nconst INSTANCE_KEY = Symbol('TdLoading');\n\nconst createInstance = (el: HTMLElement, binding: DirectiveBinding) => {\n  const { fullscreen, inheritColor } = binding.modifiers;\n  const options: TdLoadingProps = {\n    attach: () => el,\n    fullscreen: fullscreen ?? false,\n    inheritColor: inheritColor ?? false,\n    loading: binding.value,\n  };\n\n  el[INSTANCE_KEY] = {\n    options,\n    instance: produceLoading(options),\n  };\n};\n\nexport const vLoading: Directive = {\n  mounted(el, binding) {\n    if (binding.value) {\n      createInstance(el, binding);\n    }\n  },\n  updated(el, binding) {\n    const instance = el[INSTANCE_KEY];\n    const { value, oldValue } = binding;\n    if (!!oldValue !== !!value) {\n      if (value) {\n        createInstance(el, binding);\n      } else {\n        instance?.instance.hide();\n      }\n    }\n  },\n  unmounted(el) {\n    el[INSTANCE_KEY]?.instance.hide();\n  },\n};\n"],"names":["INSTANCE_KEY","Symbol","createInstance","el","binding","modifiers","fullscreen","inheritColor","options","attach","loading","value","instance","produceLoading","vLoading","mounted","updated","oldValue","hide","unmounted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,IAAMA,YAAA,GAAeC,OAAO,WAAW,CAAA,CAAA;AAEvC,IAAMC,cAAA,GAAiB,SAAjBA,cAAA,CAAkBC,EAAA,EAAiBC,OAA8B,EAAA;EACrE,IAAqCA,kBAAAA,GAAAA,OAAQ,CAAAC,SAAA;AAArCC,IAAAA,UAAA,sBAAAA,UAAA;AAAYC,IAAAA,YAAa,sBAAbA,YAAa,CAAA;AACjC,EAAA,IAAMC,OAA0B,GAAA;AAC9BC,IAAAA,QAAQ,SAAA,MAAA,GAAA;AAAA,MAAA,OAAMN,EAAA,CAAA;AAAA,KAAA;AACdG,IAAAA,YAAYA,UAAc,KAAA,IAAA,IAAdA,UAAc,KAAdA,KAAAA,CAAAA,GAAAA,UAAc,GAAA,KAAA;AAC1BC,IAAAA,cAAcA,YAAgB,KAAA,IAAA,IAAhBA,YAAgB,KAAhBA,KAAAA,CAAAA,GAAAA,YAAgB,GAAA,KAAA;IAC9BG,SAASN,OAAQ,CAAAO,KAAAA;GACnB,CAAA;EAEAR,EAAA,CAAGH,YAAgB,CAAA,GAAA;AACjBQ,IAAAA,OAAA,EAAAA,OAAA;IACAI,QAAA,EAAUC,cAAeL,OAAO,CAAA;GAClC,CAAA;AACF,CAAA,CAAA;AAEO,IAAMM,QAAsB,GAAA;AACjCC,EAAAA,OAAA,EAAQZ,SAAAA,OAAAA,CAAAA,IAAIC,OAAS,EAAA;IACnB,IAAIA,QAAQO,KAAO,EAAA;AACjBT,MAAAA,cAAA,CAAeC,IAAIC,OAAO,CAAA,CAAA;AAC5B,KAAA;GACF;AACAY,EAAAA,OAAA,EAAQb,SAAAA,OAAAA,CAAAA,IAAIC,OAAS,EAAA;AACnB,IAAA,IAAMQ,WAAWT,EAAG,CAAAH,YAAA,CAAA,CAAA;AACd,IAAA,IAAEW,KAAO,GAAaP,OAAA,CAApBO,KAAO;MAAAM,QAAA,GAAab,OAAA,CAAba,QAAA,CAAA;AACf,IAAA,IAAI,CAAC,CAACA,QAAa,KAAA,CAAC,CAACN,KAAO,EAAA;AAC1B,MAAA,IAAIA,KAAO,EAAA;AACTT,QAAAA,cAAA,CAAeC,IAAIC,OAAO,CAAA,CAAA;AAC5B,OAAO,MAAA;QACLQ,QAAA,KAAA,IAAA,IAAAA,QAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,QAAA,CAAUA,SAASM,IAAK,EAAA,CAAA;AAC1B,OAAA;AACF,KAAA;GACF;EACAC,8BAAUhB,EAAI,EAAA;AAAA,IAAA,IAAA,gBAAA,CAAA;IACT,CAAAA,gBAAAA,GAAAA,EAAA,CAAAH,YAAA,CAAA,qDAAA,gBAAeY,CAAAA,SAASM,IAAK,EAAA,CAAA;AAClC,GAAA;AACF;;;;"}