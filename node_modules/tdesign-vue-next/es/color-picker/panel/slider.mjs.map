{"version":3,"file":"slider.mjs","sources":["../../../src/color-picker/panel/slider.tsx"],"sourcesContent":["import { computed, defineComponent, onBeforeUnmount, onMounted, PropType, reactive, ref } from 'vue';\nimport { SLIDER_DEFAULT_WIDTH } from '../const';\nimport { Draggable, Coordinate } from '../utils';\nimport { useBaseClassName } from '../hooks';\nimport baseProps from './base-props';\n\nexport default defineComponent({\n  name: 'ColorSlider',\n  props: {\n    ...baseProps,\n    className: {\n      type: String,\n      default: '',\n    },\n    value: {\n      type: Number,\n      default: 0,\n    },\n    maxValue: {\n      type: Number,\n      default: 360,\n    },\n    railStyle: {\n      type: Object as PropType<any>,\n    },\n    type: {\n      type: String as PropType<'hue' | 'alpha'>,\n      default: 'hue',\n    },\n  },\n  setup(props) {\n    const baseClassName = useBaseClassName();\n    const refPanel = ref<HTMLElement>(null);\n    const refThumb = ref<HTMLElement>(null);\n    const dragInstance = ref<Draggable>(null);\n    const panelRect = reactive({\n      width: SLIDER_DEFAULT_WIDTH,\n    });\n    const styles = computed(() => {\n      const { width } = panelRect;\n      if (!width) {\n        return;\n      }\n      const left = Math.round((props.value / props.maxValue) * width);\n      return {\n        left: `${left}px`,\n        color: props.color.rgb,\n      };\n    });\n\n    const handleDrag = (coordinate: Coordinate, isEnded?: boolean) => {\n      if (props.disabled) {\n        return;\n      }\n      const { width } = panelRect;\n      const { x } = coordinate;\n      const value = Math.round((x / width) * props.maxValue * 100) / 100;\n      props.onChange(value, isEnded);\n    };\n\n    const handleDragEnd = (coordinate: Coordinate) => {\n      if (props.disabled) {\n        return;\n      }\n      handleDrag(coordinate, true);\n    };\n\n    onMounted(() => {\n      panelRect.width = refPanel.value.offsetWidth || SLIDER_DEFAULT_WIDTH;\n      dragInstance.value = new Draggable(refPanel.value, {\n        start: () => {\n          // pop模式下由于是隐藏显示，这个宽度让其每次点击的时候重新计算\n          panelRect.width = refPanel.value.offsetWidth;\n        },\n        drag: (coordinate: Coordinate) => {\n          handleDrag(coordinate);\n        },\n        end: handleDragEnd,\n      });\n    });\n\n    onBeforeUnmount(() => {\n      dragInstance.value.destroy();\n    });\n\n    return {\n      baseClassName,\n      refThumb,\n      refPanel,\n      styles,\n    };\n  },\n  render() {\n    const { baseClassName, className, railStyle, styles, type, color } = this;\n    const paddingStyle = {\n      background: `linear-gradient(90deg, rgba(0,0,0,.0) 0%, rgba(0,0,0,.0) 93%, ${color.rgb} 93%, ${color.rgb} 100%)`,\n    };\n    return (\n      <div class={[`${baseClassName}__slider-wrapper`, `${baseClassName}__slider-wrapper--${type}-type`]}>\n        {type === 'alpha' && <div className={`${baseClassName}__slider-padding`} style={paddingStyle} />}\n        <div class={[`${baseClassName}__slider`, className]} ref=\"refPanel\">\n          <div class={`${baseClassName}__rail`} style={railStyle}></div>\n          <span class={[`${baseClassName}__thumb`]} role=\"slider\" tabindex={0} ref=\"refThumb\" style={styles}></span>\n        </div>\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","baseProps","className","type","String","value","Number","maxValue","railStyle","Object","setup","baseClassName","useBaseClassName","refPanel","ref","refThumb","dragInstance","panelRect","reactive","width","SLIDER_DEFAULT_WIDTH","styles","computed","left","Math","round","color","rgb","handleDrag","coordinate","isEnded","disabled","x","onChange","handleDragEnd","onMounted","offsetWidth","Draggable","start","drag","end","onBeforeUnmount","destroy","render","paddingStyle","background","_createVNode"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,kBAAeA,eAAgB,CAAA;AAC7BC,EAAAA,IAAM,EAAA,aAAA;AACNC,EAAAA,KAAO,kCACFC,SAAA,CAAA,EAAA,EAAA,EAAA;AACHC,IAAAA,SAAW,EAAA;AACTC,MAAAA,IAAM,EAAAC,MAAA;MACN,SAAS,EAAA,EAAA;KACX;AACAC,IAAAA,KAAO,EAAA;AACLF,MAAAA,IAAM,EAAAG,MAAA;MACN,SAAS,EAAA,CAAA;KACX;AACAC,IAAAA,QAAU,EAAA;AACRJ,MAAAA,IAAM,EAAAG,MAAA;MACN,SAAS,EAAA,GAAA;KACX;AACAE,IAAAA,SAAW,EAAA;AACTL,MAAAA,IAAM,EAAAM,MAAAA;KACR;AACAN,IAAAA,IAAM,EAAA;AACJA,MAAAA,IAAM,EAAAC,MAAA;MACN,SAAS,EAAA,KAAA;AACX,KAAA;GACF,CAAA;EACAM,sBAAMV,KAAO,EAAA;IACX,IAAMW,gBAAgBC,gBAAiB,EAAA,CAAA;AACjC,IAAA,IAAAC,QAAA,GAAWC,IAAiB,IAAI,CAAA,CAAA;AAChC,IAAA,IAAAC,QAAA,GAAWD,IAAiB,IAAI,CAAA,CAAA;AAChC,IAAA,IAAAE,YAAA,GAAeF,IAAe,IAAI,CAAA,CAAA;IACxC,IAAMG,YAAYC,QAAS,CAAA;AACzBC,MAAAA,KAAO,EAAAC,oBAAAA;AACT,KAAC,CAAA,CAAA;AACK,IAAA,IAAAC,MAAA,GAASC,SAAS,YAAM;AACtB,MAAA,IAAEH,QAAUF,SAAA,CAAVE;MACR,IAAI,CAACA,KAAO,EAAA;AACV,QAAA,OAAA;AACF,OAAA;AACA,MAAA,IAAMI,OAAOC,IAAK,CAAAC,KAAA,CAAOzB,MAAMK,KAAQ,GAAAL,KAAA,CAAMO,WAAYY,KAAK,CAAA,CAAA;MACvD,OAAA;QACLI,gBAASA,IAAA,EAAA,IAAA,CAAA;AACTG,QAAAA,KAAA,EAAO1B,MAAM0B,KAAM,CAAAC,GAAAA;OACrB,CAAA;AACF,KAAC,CAAA,CAAA;IAEK,IAAAC,UAAA,GAAa,SAAbA,UAAA,CAAcC,UAAA,EAAwBC,OAAsB,EAAA;MAChE,IAAI9B,MAAM+B,QAAU,EAAA;AAClB,QAAA,OAAA;AACF,OAAA;AACM,MAAA,IAAEZ,QAAUF,SAAA,CAAVE;AACF,MAAA,IAAEa,IAAMH,UAAA,CAANG;AACF,MAAA,IAAA3B,KAAA,GAAQmB,KAAKC,KAAO,CAAAO,CAAA,GAAIb,QAASnB,KAAM,CAAAO,QAAA,GAAW,GAAG,CAAI,GAAA,GAAA,CAAA;AACzDP,MAAAA,KAAA,CAAAiC,QAAA,CAAS5B,OAAOyB,OAAO,CAAA,CAAA;KAC/B,CAAA;AAEM,IAAA,IAAAI,aAAA,GAAgB,SAAhBA,aAAA,CAAiBL,UAA2B,EAAA;MAChD,IAAI7B,MAAM+B,QAAU,EAAA;AAClB,QAAA,OAAA;AACF,OAAA;AACAH,MAAAA,UAAA,CAAWC,YAAY,IAAI,CAAA,CAAA;KAC7B,CAAA;AAEAM,IAAAA,SAAA,CAAU,YAAM;MACJlB,SAAA,CAAAE,KAAA,GAAQN,QAAS,CAAAR,KAAA,CAAM+B,WAAe,IAAAhB,oBAAA,CAAA;MAChDJ,YAAA,CAAaX,KAAQ,GAAA,IAAIgC,SAAU,CAAAxB,QAAA,CAASR,KAAO,EAAA;AACjDiC,QAAAA,OAAO,SAAM,KAAA,GAAA;AAEDrB,UAAAA,SAAA,CAAAE,KAAA,GAAQN,SAASR,KAAM,CAAA+B,WAAA,CAAA;SACnC;QACAG,IAAA,EAAM,SAACV,IAAAA,CAAAA,UAA2B,EAAA;UAChCD,UAAA,CAAWC,UAAU,CAAA,CAAA;SACvB;AACAW,QAAAA,GAAK,EAAAN,aAAAA;AACP,OAAC,CAAA,CAAA;AACH,KAAC,CAAA,CAAA;AAEDO,IAAAA,eAAA,CAAgB,YAAM;AACpBzB,MAAAA,YAAA,CAAaX,MAAMqC,OAAQ,EAAA,CAAA;AAC7B,KAAC,CAAA,CAAA;IAEM,OAAA;AACL/B,MAAAA,aAAA,EAAAA,aAAA;AACAI,MAAAA,QAAA,EAAAA,QAAA;AACAF,MAAAA,QAAA,EAAAA,QAAA;AACAQ,MAAAA,MAAA,EAAAA,MAAAA;KACF,CAAA;GACF;AACAsB,EAAAA,MAAS,EAAA,SAAA,MAAA,GAAA;AACP,IAAA,IAAQhC,aAAe,GAA8C,IAAA,CAA7DA,aAAe;MAAAT,SAAA,GAA8C,IAAA,CAA9CA,SAAA;MAAWM,YAAmC,IAAA,CAAnCA;MAAWa,MAAQ,GAAgB,IAAA,CAAxBA,MAAQ;MAAAlB,IAAA,GAAgB,IAAA,CAAhBA,IAAA;MAAMuB,QAAU,IAAA,CAAVA;AAC3D,IAAA,IAAMkB,YAAe,GAAA;AACnBC,MAAAA,UAAY,0EAAiEnB,KAAM,CAAAC,GAAA,EAAYD,QAAAA,CAAAA,CAAAA,MAAAA,CAAAA,KAAM,CAAAC,GAAA,EAAA,QAAA,CAAA;KACvG,CAAA;AAEE,IAAA,OAAAmB,WAAA,CAAA,KAAA,EAAA;AAAA,MAAA,OAAA,EAAY,CAAInC,EAAAA,CAAAA,MAAAA,CAAAA,aAAiC,EAAGA,kBAAAA,CAAAA,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,4CAAkCR,IAAW,EAAA,OAAA,CAAA,CAAA;KAC9FA,EAAAA,CAAAA,IAAA,KAAS;6BAA8BQ,aAAA,EAAA,kBAAA,CAAA;MAAA,OAAwCiC,EAAAA,YAAAA;KAAc,EAAA,IAAA,CAAA,EAAAE,WAAA,CAAA,KAAA,EAAA;AAAA,MAAA,OAAA,EAClF,CAAInC,EAAAA,CAAAA,MAAAA,CAAAA,aAAyB,EAAAT,UAAAA,CAAAA,EAAAA,SAAS;WAAO,EAAA,UAAA;AAAA,KAAA,EAAA,CAAA4C,WAAA,CAAA,KAAA,EAAA;AAAA,MAAA,OAAA,EAAA,EAAA,CAAA,MAAA,CACxCnC,aAAA,EAAA,QAAA,CAAA;MAAA,OAA8BH,EAAAA,SAAAA;AAAW,KAAA,EAAA,IAAA,CAAA,EAAAsC,WAAA,CAAA,MAAA,EAAA;MAAA,OAC3C,EAAA,CAAA,EAAA,CAAA,MAAA,CAAInC,aAAsB,EAAA,SAAA,CAAA,CAAA;AAAA,MAAA,MAAA,EAAQ,QAAA;AAAA,MAAA,UAAA,EAAmB,CAAA;AAAA,MAAA,KAAA,EAAO,UAAA;MAAA,OAAkBU,EAAAA,MAAAA;AAAQ,KAAA,EAAA,IAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAI3G,GAAA;AACF,CAAC,CAAA;;;;"}