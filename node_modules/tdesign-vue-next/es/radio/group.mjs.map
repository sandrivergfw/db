{"version":3,"file":"group.mjs","sources":["../../src/radio/group.tsx"],"sourcesContent":["import { VNode, defineComponent, h, provide, reactive, ref, computed, onMounted, watch, nextTick, toRefs } from 'vue';\nimport isString from 'lodash/isString';\nimport isNumber from 'lodash/isNumber';\nimport isNil from 'lodash/isNil';\nimport props from './radio-group-props';\nimport { RadioOptionObj, RadioOption } from './type';\nimport Radio from './radio';\nimport { RadioGroupInjectionKey } from './constants';\n\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport useVModel from '../hooks/useVModel';\nimport { useTNodeDefault } from '../hooks/tnode';\n\nexport default defineComponent({\n  name: 'TRadioGroup',\n  props: { ...props },\n  setup(props) {\n    const { value, modelValue } = toRefs(props);\n    const [innerValue, setInnerValue] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n\n    /** calculate bar style */\n    const radioGroupRef = ref<HTMLElement>();\n    const radioBtnName = usePrefixClass('radio-button');\n    const { STATUS, SIZE } = useCommonClassName();\n\n    const checkedClassName = computed(() => `.${radioBtnName.value}.${STATUS.value.checked}`);\n\n    const barStyle = ref({ width: '0px', left: '0px' });\n\n    const calcDefaultBarStyle = () => {\n      const div = document.createElement('div');\n      div.setAttribute('style', 'position: absolute; visibility: hidden;');\n      div.appendChild(radioGroupRef.value.cloneNode(true));\n      document.body.appendChild(div);\n\n      const defaultCheckedRadio: HTMLElement = div.querySelector(checkedClassName.value);\n      const { offsetWidth, offsetLeft } = defaultCheckedRadio;\n      barStyle.value = { width: `${offsetWidth}px`, left: `${offsetLeft}px` };\n      document.body.removeChild(div);\n    };\n\n    const calcBarStyle = () => {\n      if (props.variant === 'outline') return;\n\n      const checkedRadio: HTMLElement = radioGroupRef.value.querySelector(checkedClassName.value);\n      if (!checkedRadio) {\n        barStyle.value = { width: '0px', left: '0px' };\n        return;\n      }\n\n      const { offsetWidth, offsetLeft } = checkedRadio;\n      // current node is not renderedï¼Œfallback to default render\n      if (!offsetWidth) {\n        calcDefaultBarStyle();\n      } else {\n        barStyle.value = { width: `${offsetWidth}px`, left: `${offsetLeft}px` };\n      }\n    };\n\n    watch(innerValue, async () => {\n      await nextTick();\n      calcBarStyle();\n    });\n    onMounted(() => {\n      calcBarStyle();\n    });\n    /** calculate bar style end */\n\n    const { name, disabled } = toRefs(props);\n    provide(\n      RadioGroupInjectionKey,\n      reactive({\n        name,\n        disabled,\n        value: innerValue,\n        setValue: setInnerValue,\n      }),\n    );\n\n    const radioGroupName = usePrefixClass('radio-group');\n    const renderSlot = useTNodeDefault();\n    const renderBlock = (): VNode => {\n      if (props.variant.includes('filled') && !isNil(innerValue.value))\n        return <div style={barStyle.value} class={`${radioGroupName.value}__bg-block`} />;\n    };\n    const renderOptions = (): VNode[] => {\n      return props.options?.map((option: RadioOption) => {\n        let opt = option as RadioOptionObj;\n        if (isNumber(option) || isString(option)) {\n          opt = { value: option, label: option.toString() };\n        }\n        return (\n          <Radio\n            key={`radio-group-options-${opt.value}-${Math.random()}`}\n            name={props.name}\n            checked={innerValue.value === opt.value}\n            disabled={'disabled' in opt ? opt.disabled : props.disabled}\n            value={opt.value}\n          >\n            {typeof opt.label === 'function' ? opt.label(h) : opt.label}\n          </Radio>\n        );\n      });\n    };\n\n    const groupClass = computed(() => [\n      `${radioGroupName.value}`,\n      SIZE.value[props.size],\n      {\n        [`${radioGroupName.value}__outline`]: props.variant === 'outline',\n        [`${radioGroupName.value}--filled`]: props.variant.includes('filled'),\n        [`${radioGroupName.value}--primary-filled`]: props.variant === 'primary-filled',\n      },\n    ]);\n\n    return () => (\n      <div ref={radioGroupRef} class={groupClass.value}>\n        {renderSlot('default') || renderOptions()}\n        {renderBlock()}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","setup","toRefs","value","modelValue","useVModel","defaultValue","onChange","innerValue","setInnerValue","radioGroupRef","ref","radioBtnName","usePrefixClass","useCommonClassName","STATUS","SIZE","checkedClassName","computed","checked","barStyle","width","left","calcDefaultBarStyle","div","document","createElement","setAttribute","appendChild","cloneNode","body","defaultCheckedRadio","querySelector","offsetWidth","offsetLeft","removeChild","calcBarStyle","variant","checkedRadio","watch","_regeneratorRuntime","nextTick","onMounted","disabled","provide","RadioGroupInjectionKey","reactive","setValue","radioGroupName","renderSlot","useTNodeDefault","renderBlock","includes","isNil","_createVNode","renderOptions","options","map","option","opt","isNumber","isString","label","toString","Radio","Math","random","h","groupClass","size"],"mappings":"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"}