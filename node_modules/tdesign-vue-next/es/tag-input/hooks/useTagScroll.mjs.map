{"version":3,"file":"useTagScroll.mjs","sources":["../../../src/tag-input/hooks/useTagScroll.ts"],"sourcesContent":["/**\n * 当标签数量过多时，输入框显示不下，则需要滚动查看，以下为滚动逻辑\n * 如果标签过多时的处理方式，是标签省略，则不需要此功能\n */\n\nimport { onMounted, onUnmounted, ref, toRefs } from 'vue';\nimport { TdTagInputProps } from '../type';\n\nexport default function useTagScroll(props: TdTagInputProps) {\n  const tagInputRef = ref();\n  const { excessTagsDisplayType, readonly, disabled } = toRefs(props);\n  // 允许向右滚动的最大距离\n  const scrollDistance = ref(0);\n  const scrollElement = ref<HTMLElement>();\n  const mouseEnterTimer = ref();\n\n  const updateScrollElement = (element: HTMLElement) => {\n    const inputElement = element.children[0] as HTMLElement;\n    scrollElement.value = inputElement;\n  };\n\n  const updateScrollDistance = () => {\n    scrollDistance.value = scrollElement.value.scrollWidth - scrollElement.value.clientWidth;\n  };\n\n  const scrollTo = (distance: number) => {\n    scrollElement.value?.scroll({ left: distance, behavior: 'smooth' });\n  };\n\n  const scrollToRight = () => {\n    updateScrollDistance();\n    scrollTo(scrollDistance.value);\n  };\n\n  const scrollToLeft = () => {\n    scrollTo(0);\n  };\n\n  // TODO：MAC 电脑横向滚动，Windows 纵向滚动。当前只处理了横向滚动\n  const onWheel = ({ e }: { e: WheelEvent }) => {\n    if (readonly.value || disabled.value) return;\n    if (!scrollElement.value) return;\n    if (e.deltaX > 0) {\n      const distance = Math.min(scrollElement.value.scrollLeft + 120, scrollDistance.value);\n      scrollTo(distance);\n    } else {\n      const distance = Math.max(scrollElement.value.scrollLeft - 120, 0);\n      scrollTo(distance);\n    }\n  };\n\n  // 鼠标 hover，自动滑动到最右侧，以便输入新标签\n  const scrollToRightOnEnter = () => {\n    if (excessTagsDisplayType.value !== 'scroll') return;\n    // 一闪而过的 mousenter 不需要执行\n    mouseEnterTimer.value = setTimeout(() => {\n      scrollToRight();\n      clearTimeout(mouseEnterTimer.value);\n    }, 100);\n  };\n\n  const scrollToLeftOnLeave = () => {\n    if (excessTagsDisplayType.value !== 'scroll') return;\n    scrollTo(0);\n    clearTimeout(mouseEnterTimer.value);\n  };\n\n  const init = () => {\n    const element = tagInputRef.value?.$el;\n    if (!element) return;\n    updateScrollElement(element);\n  };\n\n  const clear = () => {\n    clearTimeout(mouseEnterTimer.value);\n  };\n\n  onMounted(init);\n\n  onUnmounted(clear);\n\n  return {\n    tagInputRef,\n    scrollElement,\n    scrollDistance,\n    scrollTo,\n    scrollToRight,\n    scrollToLeft,\n    updateScrollElement,\n    updateScrollDistance,\n    onWheel,\n    scrollToRightOnEnter,\n    scrollToLeftOnLeave,\n  };\n}\n"],"names":["useTagScroll","props","tagInputRef","ref","toRefs","excessTagsDisplayType","readonly","disabled","scrollDistance","scrollElement","mouseEnterTimer","updateScrollElement","element","inputElement","children","value","updateScrollDistance","scrollWidth","clientWidth","scrollTo","distance","scroll","left","behavior","scrollToRight","scrollToLeft","onWheel","e","deltaX","Math","min","scrollLeft","max","scrollToRightOnEnter","setTimeout","clearTimeout","scrollToLeftOnLeave","init","$el","clear","onMounted","onUnmounted"],"mappings":"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"}