{"version":3,"file":"useSliderMark.js","sources":["../../../src/slider/hooks/useSliderMark.tsx"],"sourcesContent":["import { computed, VNode, Ref } from 'vue';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { SliderMarks } from '../type';\nimport { TNode } from '../../common';\nimport log from '../../_common/js/log/log';\nimport { getStopStyle } from '../util/common';\nimport TSliderMark from '../slider-mark';\n\ninterface MarkItem {\n  point: number;\n  position: number;\n  mark: string | number | TNode<{ value: number }>;\n}\n\ninterface useSliderMarkProps {\n  max: number;\n  min: number;\n  marks: number[] | SliderMarks;\n  vertical: boolean;\n  prefixName: string;\n}\n\n/**\n * 聚合管理刻度值渲染逻辑\n */\nexport const useSliderMark = (config: Ref<useSliderMarkProps>) => {\n  const name = config.value.prefixName;\n  const markList = computed(() => {\n    const markProps = config.value;\n    if (!markProps.marks) {\n      return [];\n    }\n    const legalMarks: Array<MarkItem> = [];\n    if (Array.isArray(markProps.marks)) {\n      const marksList = cloneDeep(markProps.marks).sort((a, b) => a - b);\n      const maxLimit = Math.max(...marksList, markProps.max);\n      const minLimit = Math.min(...marksList, markProps.min);\n      if (minLimit < markProps.min) {\n        log.errorOnce('TSlider', 'marks min value should >= props min');\n      }\n      if (maxLimit > markProps.max) {\n        log.errorOnce('TSlider', 'marks max value should <= props max');\n      }\n      marksList.forEach((item) => {\n        legalMarks.push({\n          point: item,\n          position: ((item - minLimit) / (maxLimit - minLimit)) * 100,\n          mark: item,\n        });\n      });\n    } else {\n      Object.keys(markProps.marks)\n        .map(parseFloat)\n        .sort((a, b) => a - b)\n        .filter((point) => point <= markProps.max && point >= markProps.min)\n        .forEach((point) => {\n          const item: MarkItem = {\n            point,\n            position: ((point - markProps.min) * 100) / (markProps.max - markProps.min),\n            mark: markProps.marks[point],\n          };\n          legalMarks.push(item);\n        });\n    }\n    return legalMarks;\n  });\n\n  const renderMask = (onChangeFn?: (point: number) => void): VNode => {\n    if (!markList.value.length) return null;\n\n    return (\n      <div>\n        <div class={`${name}__stops`}>\n          {markList.value.map((item, index) => {\n            if (item.position === 0 || item.position === 100) return null;\n            return (\n              <div\n                class={`${name}__stop ${name}__mark-stop`}\n                style={getStopStyle(item.position, config.value.vertical)}\n                key={index}\n              />\n            );\n          })}\n        </div>\n        <div class={`${name}__mark`}>\n          {markList.value.map((item, key) => (\n            <TSliderMark\n              mark={item.mark as any}\n              point={item.point}\n              key={key}\n              style={getStopStyle(item.position, config.value.vertical)}\n              onClickMarkPoint={onChangeFn}\n            />\n          ))}\n        </div>\n      </div>\n    );\n  };\n\n  return renderMask;\n};\n"],"names":["useSliderMark","config","name","value","prefixName","markList","computed","markProps","marks","legalMarks","Array","isArray","marksList","cloneDeep","sort","a","b","maxLimit","Math","max","_toConsumableArray","minLimit","min","log","errorOnce","forEach","item","push","point","position","mark","Object","keys","map","parseFloat","filter","renderMask","onChangeFn","length","_createVNode","index","getStopStyle","vertical","key","TSliderMark"],"mappings":"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"}