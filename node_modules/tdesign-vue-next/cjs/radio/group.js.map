{"version":3,"file":"group.js","sources":["../../src/radio/group.tsx"],"sourcesContent":["import { VNode, defineComponent, h, provide, reactive, ref, computed, onMounted, watch, nextTick, toRefs } from 'vue';\nimport isString from 'lodash/isString';\nimport isNumber from 'lodash/isNumber';\nimport isNil from 'lodash/isNil';\nimport props from './radio-group-props';\nimport { RadioOptionObj, RadioOption } from './type';\nimport Radio from './radio';\nimport { RadioGroupInjectionKey } from './constants';\n\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport useVModel from '../hooks/useVModel';\nimport { useTNodeDefault } from '../hooks/tnode';\n\nexport default defineComponent({\n  name: 'TRadioGroup',\n  props: { ...props },\n  setup(props) {\n    const { value, modelValue } = toRefs(props);\n    const [innerValue, setInnerValue] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n\n    /** calculate bar style */\n    const radioGroupRef = ref<HTMLElement>();\n    const radioBtnName = usePrefixClass('radio-button');\n    const { STATUS, SIZE } = useCommonClassName();\n\n    const checkedClassName = computed(() => `.${radioBtnName.value}.${STATUS.value.checked}`);\n\n    const barStyle = ref({ width: '0px', left: '0px' });\n\n    const calcDefaultBarStyle = () => {\n      const div = document.createElement('div');\n      div.setAttribute('style', 'position: absolute; visibility: hidden;');\n      div.appendChild(radioGroupRef.value.cloneNode(true));\n      document.body.appendChild(div);\n\n      const defaultCheckedRadio: HTMLElement = div.querySelector(checkedClassName.value);\n      const { offsetWidth, offsetLeft } = defaultCheckedRadio;\n      barStyle.value = { width: `${offsetWidth}px`, left: `${offsetLeft}px` };\n      document.body.removeChild(div);\n    };\n\n    const calcBarStyle = () => {\n      if (props.variant === 'outline') return;\n\n      const checkedRadio: HTMLElement = radioGroupRef.value.querySelector(checkedClassName.value);\n      if (!checkedRadio) {\n        barStyle.value = { width: '0px', left: '0px' };\n        return;\n      }\n\n      const { offsetWidth, offsetLeft } = checkedRadio;\n      // current node is not renderedï¼Œfallback to default render\n      if (!offsetWidth) {\n        calcDefaultBarStyle();\n      } else {\n        barStyle.value = { width: `${offsetWidth}px`, left: `${offsetLeft}px` };\n      }\n    };\n\n    watch(innerValue, async () => {\n      await nextTick();\n      calcBarStyle();\n    });\n    onMounted(() => {\n      calcBarStyle();\n    });\n    /** calculate bar style end */\n\n    const { name, disabled } = toRefs(props);\n    provide(\n      RadioGroupInjectionKey,\n      reactive({\n        name,\n        disabled,\n        value: innerValue,\n        setValue: setInnerValue,\n      }),\n    );\n\n    const radioGroupName = usePrefixClass('radio-group');\n    const renderSlot = useTNodeDefault();\n    const renderBlock = (): VNode => {\n      if (props.variant.includes('filled') && !isNil(innerValue.value))\n        return <div style={barStyle.value} class={`${radioGroupName.value}__bg-block`} />;\n    };\n    const renderOptions = (): VNode[] => {\n      return props.options?.map((option: RadioOption) => {\n        let opt = option as RadioOptionObj;\n        if (isNumber(option) || isString(option)) {\n          opt = { value: option, label: option.toString() };\n        }\n        return (\n          <Radio\n            key={`radio-group-options-${opt.value}-${Math.random()}`}\n            name={props.name}\n            checked={innerValue.value === opt.value}\n            disabled={'disabled' in opt ? opt.disabled : props.disabled}\n            value={opt.value}\n          >\n            {typeof opt.label === 'function' ? opt.label(h) : opt.label}\n          </Radio>\n        );\n      });\n    };\n\n    const groupClass = computed(() => [\n      `${radioGroupName.value}`,\n      SIZE.value[props.size],\n      {\n        [`${radioGroupName.value}__outline`]: props.variant === 'outline',\n        [`${radioGroupName.value}--filled`]: props.variant.includes('filled'),\n        [`${radioGroupName.value}--primary-filled`]: props.variant === 'primary-filled',\n      },\n    ]);\n\n    return () => (\n      <div ref={radioGroupRef} class={groupClass.value}>\n        {renderSlot('default') || renderOptions()}\n        {renderBlock()}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","setup","toRefs","value","modelValue","useVModel","defaultValue","onChange","_slicedToArray","innerValue","setInnerValue","radioGroupRef","ref","radioBtnName","usePrefixClass","useCommonClassName","STATUS","SIZE","checkedClassName","computed","checked","barStyle","width","left","calcDefaultBarStyle","div","document","createElement","setAttribute","appendChild","cloneNode","body","defaultCheckedRadio","querySelector","offsetWidth","offsetLeft","removeChild","calcBarStyle","variant","checkedRadio","watch","_asyncToGenerator","_regeneratorRuntime","nextTick","onMounted","disabled","provide","RadioGroupInjectionKey","reactive","setValue","radioGroupName","renderSlot","useTNodeDefault","renderBlock","includes","isNil","_createVNode","renderOptions","options","map","option","opt","isNumber","isString","label","toString","Radio","Math","random","h","groupClass","size"],"mappings":"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"}