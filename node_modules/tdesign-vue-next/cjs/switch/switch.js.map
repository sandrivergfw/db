{"version":3,"file":"switch.js","sources":["../../src/switch/switch.tsx"],"sourcesContent":["import { defineComponent, h, VNodeChild, computed, watch, toRefs } from 'vue';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport TLoading from '../loading';\nimport props from './props';\nimport { TNodeReturnValue } from '../common';\n\n// hooks\nimport { useFormDisabled } from '../form/hooks';\nimport useVModel from '../hooks/useVModel';\n\nexport default defineComponent({\n  name: 'TSwitch',\n  props: { ...props },\n\n  setup(props, { slots }) {\n    const disabled = useFormDisabled();\n    const COMPONENT_NAME = usePrefixClass('switch');\n    const { STATUS, SIZE } = useCommonClassName();\n    // values\n    const { value, modelValue } = toRefs(props);\n    const [innerValue, setSwitchVal] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n\n    const activeValue = computed(() => {\n      if (props.customValue && props.customValue.length > 0) {\n        return props.customValue[0];\n      }\n      return true;\n    });\n    const inactiveValue = computed(() => {\n      if (props.customValue && props.customValue.length > 1) {\n        return props.customValue[1];\n      }\n      return false;\n    });\n\n    // methods\n    function handleToggle() {\n      const checked = innerValue.value === activeValue.value ? inactiveValue.value : activeValue.value;\n      // emits\n      setSwitchVal(checked);\n    }\n\n    function toggle() {\n      if (disabled.value || props.loading) {\n        return;\n      }\n      handleToggle();\n    }\n\n    // classes\n    const classes = computed(() => [\n      `${COMPONENT_NAME.value}`,\n      SIZE.value[props.size],\n      {\n        [STATUS.value.disabled]: disabled.value,\n        [STATUS.value.loading]: props.loading,\n        [STATUS.value.checked]: innerValue.value === activeValue.value || props.modelValue === activeValue.value,\n      },\n    ]);\n    const nodeClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__handle`,\n        {\n          [STATUS.value.disabled]: disabled.value,\n          [STATUS.value.loading]: props.loading,\n        },\n      ];\n    });\n    const contentClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__content`,\n        SIZE.value[props.size],\n        {\n          [STATUS.value.disabled]: disabled.value,\n        },\n      ];\n    });\n\n    watch(\n      innerValue,\n      (val) => {\n        if (props.customValue && props.customValue.length && !props.customValue.includes(val)) {\n          throw new Error(`value is not in ${JSON.stringify(props.customValue)}`);\n        }\n      },\n      {\n        immediate: true,\n      },\n    );\n\n    const content = computed<VNodeChild>(() => {\n      if (typeof props.label === 'function') {\n        return props.label(h, { value: innerValue.value });\n      }\n      if (typeof props.label === 'string') {\n        return props.label;\n      }\n      if (Array.isArray(props.label) && props.label.length) {\n        const label = innerValue.value === activeValue.value ? props.label[0] : props.label[1];\n        if (!label) return;\n        if (typeof label === 'string') {\n          return label;\n        }\n        if (typeof label === 'function') {\n          return label(h);\n        }\n      }\n      if (slots.label) {\n        return slots.label({ value: innerValue.value });\n      }\n      return null;\n    });\n    return () => {\n      let switchContent: VNodeChild;\n      let loadingContent: TNodeReturnValue;\n      if (props.loading) {\n        loadingContent = <TLoading size=\"small\" />;\n      } else if (content.value) {\n        switchContent = content.value;\n      }\n\n      return (\n        <div class={classes.value} disabled={disabled.value} onClick={toggle}>\n          <span class={nodeClasses.value}>{loadingContent}</span>\n          <div class={contentClasses.value}>{switchContent}</div>\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","slots","disabled","useFormDisabled","COMPONENT_NAME","usePrefixClass","useCommonClassName","STATUS","SIZE","toRefs","value","modelValue","useVModel","defaultValue","onChange","_slicedToArray","innerValue","setSwitchVal","activeValue","computed","customValue","length","inactiveValue","handleToggle","checked","toggle","loading","classes","size","_defineProperty","nodeClasses","contentClasses","watch","val","includes","Error","JSON","stringify","immediate","content","label","h","Array","isArray","switchContent","loadingContent","_createVNode","TLoading"],"mappings":"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"}