{"version":3,"file":"useState.js","sources":["../../../src/calendar/hook/useState.ts"],"sourcesContent":["import { reactive, watch } from 'vue';\nimport dayjs from 'dayjs';\n\nimport { useConfig } from '../../hooks/useConfig';\nimport { COMPONENT_NAME } from '../const';\nimport { createDefaultCurDate } from '../utils';\nimport { TdCalendarProps } from '../type';\nimport { CalendarState } from '../interface';\n\nexport function useState(props: TdCalendarProps) {\n  const { globalConfig } = useConfig(COMPONENT_NAME);\n\n  const state = reactive<CalendarState>({\n    realFirstDayOfWeek: 1,\n    curDate: null,\n    curSelectedYear: null,\n    curSelectedMonth: null,\n    curSelectedMode: null,\n    isShowWeekend: true,\n    controlSize: 'medium',\n  });\n\n  function toToday() {\n    const curDate = createDefaultCurDate();\n    state.curSelectedYear = curDate.year();\n    state.curSelectedMonth = parseInt(curDate.format('M'), 10);\n  }\n\n  function setCurSelectedYear(year?: TdCalendarProps['year']) {\n    const curSelectedYear = year ? parseInt(`${year}`, 10) : createDefaultCurDate().year();\n    if (!isNaN(curSelectedYear) && curSelectedYear > 0) {\n      state.curSelectedYear = curSelectedYear;\n    }\n  }\n\n  function setCurSelectedMonth(month?: TdCalendarProps['month']) {\n    const curSelectedMonth = month ? parseInt(`${month}`, 10) : parseInt(createDefaultCurDate().format('M'), 10);\n    if (!isNaN(curSelectedMonth) && curSelectedMonth > 0 && curSelectedMonth <= 12) {\n      state.curSelectedMonth = curSelectedMonth;\n    }\n  }\n\n  function setCurrentDate(value?: TdCalendarProps['value']): void {\n    state.curDate = value ? dayjs(value) : createDefaultCurDate();\n  }\n\n  function checkDayVisibled(day: number) {\n    let re = true;\n    if (!state.isShowWeekend) {\n      re = day !== 6 && day !== 7;\n    }\n    return re;\n  }\n\n  watch(\n    () => props.firstDayOfWeek,\n    () => {\n      state.realFirstDayOfWeek = props.firstDayOfWeek ?? globalConfig.value.firstDayOfWeek ?? 1;\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.value,\n    (v: TdCalendarProps['value']) => {\n      setCurrentDate(v);\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.year,\n    (v: TdCalendarProps['year']) => {\n      setCurSelectedYear(v);\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.month,\n    (v: TdCalendarProps['month']) => {\n      setCurSelectedMonth(v);\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.isShowWeekendDefault,\n    (v: TdCalendarProps['isShowWeekendDefault']) => {\n      state.isShowWeekend = v;\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.mode,\n    (v: TdCalendarProps['mode']) => {\n      state.curSelectedMode = v;\n    },\n    { immediate: true },\n  );\n\n  return {\n    state,\n    toToday,\n    checkDayVisibled,\n  };\n}\n"],"names":["useState","props","useConfig","COMPONENT_NAME","globalConfig","state","reactive","realFirstDayOfWeek","curDate","curSelectedYear","curSelectedMonth","curSelectedMode","isShowWeekend","controlSize","toToday","createDefaultCurDate","year","parseInt","format","setCurSelectedYear","isNaN","setCurSelectedMonth","month","setCurrentDate","value","dayjs","checkDayVisibled","day","re","watch","firstDayOfWeek","immediate","v","isShowWeekendDefault","mode"],"mappings":"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"}