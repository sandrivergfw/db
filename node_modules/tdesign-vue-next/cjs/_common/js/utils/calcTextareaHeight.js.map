{"version":3,"file":"calcTextareaHeight.js","sources":["../../../../src/_common/js/utils/calcTextareaHeight.ts"],"sourcesContent":["import { calculateNodeSize } from './helper';\n\ntype CalculateStyleType = {\n  height?: string,\n  minHeight?: string\n};\n\ntype LimitType = number | null;\n\nconst TEXTAREA_STYLE = `\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important\n`;\n\nlet hiddenTextarea: HTMLTextAreaElement;\n\nfunction calcTextareaHeight(\n  targetElement: HTMLTextAreaElement,\n  minRows: LimitType = 1,\n  maxRows: LimitType = null,\n): CalculateStyleType {\n  if (!hiddenTextarea) {\n    hiddenTextarea = document.createElement('textarea');\n    document.body.appendChild(hiddenTextarea);\n  }\n\n  const {\n    paddingSize,\n    borderSize,\n    boxSizing,\n    sizingStyle,\n  } = calculateNodeSize(targetElement);\n\n  hiddenTextarea.setAttribute('style', `${sizingStyle};${TEXTAREA_STYLE}`);\n  hiddenTextarea.value = targetElement.value || targetElement.placeholder || '';\n\n  let height = hiddenTextarea.scrollHeight;\n  const result: CalculateStyleType = {};\n  const isBorderbox = boxSizing === 'border-box';\n  const isContentbox = boxSizing === 'content-box';\n\n  if (isBorderbox) {\n    height += borderSize;\n  } else if (isContentbox) {\n    height -= paddingSize;\n  }\n\n  hiddenTextarea.value = '';\n  const singleRowHeight = hiddenTextarea.scrollHeight - paddingSize;\n  hiddenTextarea?.parentNode?.removeChild(hiddenTextarea);\n  // @ts-ignore\n  hiddenTextarea = null;\n\n  const calcHeight = (rows: number) => {\n    let rowsHeight = singleRowHeight * rows;\n    if (isBorderbox) {\n      rowsHeight = rowsHeight + paddingSize + borderSize;\n    }\n    return rowsHeight;\n  };\n\n  if (minRows !== null) {\n    const minHeight = calcHeight(minRows);\n    height = Math.max(minHeight, height);\n    result.minHeight = `${minHeight}px`;\n  }\n  if (maxRows !== null) {\n    height = Math.min(calcHeight(maxRows), height);\n  }\n  result.height = `${height}px`;\n  return result;\n}\n\nexport default calcTextareaHeight;\n"],"names":["TEXTAREA_STYLE","hiddenTextarea","calcTextareaHeight","targetElement","minRows","maxRows","document","createElement","body","appendChild","calculateNodeSize","paddingSize","borderSize","boxSizing","sizingStyle","setAttribute","value","placeholder","height","scrollHeight","result","isBorderbox","isContentbox","singleRowHeight","parentNode","removeChild","calcHeight","rows","rowsHeight","minHeight","Math","max","min"],"mappings":";;;;;;;;;;;;;;;;AASA,IAAMA,cAAiB,GAAA,gQAAA,CAAA;AAYvB,IAAIC,cAAA,CAAA;AAEJ,SAASC,kBACP,CAAAC,aAAA,EAGoB;AAAA,EAAA,IAAA,eAAA,EAAA,qBAAA,CAAA;EAAA,IAFpBC,OAAqB,uEAAA,CAAA,CAAA;EAAA,IACrBC,8EAAqB,IACD,CAAA;EACpB,IAAI,CAACJ,cAAgB,EAAA;AACFA,IAAAA,cAAA,GAAAK,QAAA,CAASC,cAAc,UAAU,CAAA,CAAA;AACzCD,IAAAA,QAAA,CAAAE,IAAA,CAAKC,YAAYR,cAAc,CAAA,CAAA;AAC1C,GAAA;EAEM,IAKFS,kBAAAA,GAAAA,0CAAkBP,aAAa,CAAA;AAJjCQ,IAAAA,WAAA,sBAAAA,WAAA;AACAC,IAAAA,UAAA,sBAAAA,UAAA;AACAC,IAAAA,SAAA,sBAAAA,SAAA;AACAC,IAAAA,WAAA,sBAAAA,WAAA,CAAA;EAGFb,cAAA,CAAec,YAAa,CAAA,OAAA,YAAYD,WAAA,EAAA,GAAA,CAAA,CAAA,MAAA,CAAed,cAAgB,CAAA,CAAA,CAAA;EACvEC,cAAA,CAAee,KAAQ,GAAAb,aAAA,CAAca,KAAS,IAAAb,aAAA,CAAcc,WAAe,IAAA,EAAA,CAAA;AAE3E,EAAA,IAAIC,SAASjB,cAAe,CAAAkB,YAAA,CAAA;EAC5B,IAAMC,SAA6B,EAAC,CAAA;AACpC,EAAA,IAAMC,cAAcR,SAAc,KAAA,YAAA,CAAA;AAClC,EAAA,IAAMS,eAAeT,SAAc,KAAA,aAAA,CAAA;AAEnC,EAAA,IAAIQ,WAAa,EAAA;AACLH,IAAAA,MAAA,IAAAN,UAAA,CAAA;aACDU,YAAc,EAAA;AACbJ,IAAAA,MAAA,IAAAP,WAAA,CAAA;AACZ,GAAA;EAEAV,cAAA,CAAee,KAAQ,GAAA,EAAA,CAAA;AACjB,EAAA,IAAAO,eAAA,GAAkBtB,eAAekB,YAAe,GAAAR,WAAA,CAAA;EACtC,CAAAV,eAAAA,GAAAA,cAAA,6EAAA,eAAAuB,CAAAA,UAAA,0DAAA,qBAAYC,CAAAA,YAAYxB,cAAc,CAAA,CAAA;AAErCA,EAAAA,cAAA,GAAA,IAAA,CAAA;AAEX,EAAA,IAAAyB,UAAA,GAAa,SAAbA,UAAA,CAAcC,IAAiB,EAAA;AACnC,IAAA,IAAIC,aAAaL,eAAkB,GAAAI,IAAA,CAAA;AACnC,IAAA,IAAIN,WAAa,EAAA;AACfO,MAAAA,UAAA,GAAaA,aAAajB,WAAc,GAAAC,UAAA,CAAA;AAC1C,KAAA;AACO,IAAA,OAAAgB,UAAA,CAAA;GACT,CAAA;EAEA,IAAIxB,YAAY,IAAM,EAAA;AACd,IAAA,IAAAyB,SAAA,GAAYH,WAAWtB,OAAO,CAAA,CAAA;IAC3Bc,MAAA,GAAAY,IAAA,CAAKC,GAAI,CAAAF,SAAA,EAAWX,MAAM,CAAA,CAAA;AACnCE,IAAAA,MAAA,CAAOS,YAAeA,EAAAA,CAAAA,MAAAA,CAAAA,SAAA,EAAA,IAAA,CAAA,CAAA;AACxB,GAAA;EACA,IAAIxB,YAAY,IAAM,EAAA;IACpBa,MAAA,GAASY,IAAK,CAAAE,GAAA,CAAIN,UAAW,CAAArB,OAAO,GAAGa,MAAM,CAAA,CAAA;AAC/C,GAAA;AACAE,EAAAA,MAAA,CAAOF,SAAYA,EAAAA,CAAAA,MAAAA,CAAAA,MAAA,EAAA,IAAA,CAAA,CAAA;AACZ,EAAA,OAAAE,MAAA,CAAA;AACT;;;;"}