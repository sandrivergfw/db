{"version":3,"file":"useAffix.js","sources":["../../../src/table/hooks/useAffix.ts"],"sourcesContent":["import { computed, ref, watch, onBeforeMount } from 'vue';\nimport { TdBaseTableProps } from '../type';\nimport { on, off } from '../../utils/dom';\nimport { AffixProps } from '../../affix';\n\n/**\n * 1. 表头吸顶（普通表头吸顶 和 虚拟滚动表头吸顶）\n * 2. 表尾吸底\n * 3. 底部滚动条吸底\n * 4. 分页器吸底\n */\nexport default function useAffix(props: TdBaseTableProps) {\n  const tableContentRef = ref<HTMLDivElement>();\n  // 吸顶表头\n  const affixHeaderRef = ref<HTMLDivElement>();\n  // 吸底表尾\n  const affixFooterRef = ref<HTMLDivElement>();\n  // 吸底滚动条\n  const horizontalScrollbarRef = ref<HTMLDivElement>();\n  // 吸底分页器\n  const paginationRef = ref<HTMLDivElement>();\n  // 当表格完全滚动消失在视野时，需要隐藏吸顶表头\n  const showAffixHeader = ref(true);\n  // 当表格完全滚动消失在视野时，需要隐藏吸底尾部\n  const showAffixFooter = ref(true);\n  // 当表格完全滚动消失在视野时，需要隐藏吸底分页器\n  const showAffixPagination = ref(true);\n\n  const isVirtualScroll = computed(\n    () => props.scroll && props.scroll.type === 'virtual' && (props.scroll.threshold || 100) < props.data.length,\n  );\n\n  const isAffixed = computed(\n    () => !!(props.headerAffixedTop || props.footerAffixedBottom || props.horizontalScrollAffixedBottom),\n  );\n\n  let lastScrollLeft = 0;\n  const onHorizontalScroll = (scrollElement?: HTMLElement) => {\n    if (!isAffixed.value && !isVirtualScroll.value) return;\n    let target = scrollElement;\n    if (!target && tableContentRef.value) {\n      lastScrollLeft = 0;\n      target = tableContentRef.value;\n    }\n    if (!target) return;\n    const left = target.scrollLeft;\n    // 如果 lastScrollLeft 等于 left，说明不是横向滚动，不需要更新横向滚动距离\n    if (lastScrollLeft === left) return;\n    lastScrollLeft = left;\n    // 表格内容、吸顶表头、吸底表尾、吸底横向滚动更新\n    const toUpdateScrollElement = [\n      tableContentRef.value,\n      affixHeaderRef.value,\n      affixFooterRef.value,\n      horizontalScrollbarRef.value,\n    ];\n    for (let i = 0, len = toUpdateScrollElement.length; i < len; i++) {\n      if (toUpdateScrollElement[i] && scrollElement !== toUpdateScrollElement[i]) {\n        toUpdateScrollElement[i].scrollLeft = left;\n      }\n    }\n  };\n\n  // 吸底的元素（footer、横向滚动条、分页器）是否显示\n  const isAffixedBottomElementShow = (elementRect: DOMRect, tableRect: DOMRect, headerHeight: number) =>\n    tableRect.top + headerHeight < elementRect.top && elementRect.top > elementRect.height;\n\n  const getOffsetTop = (props: boolean | AffixProps) => {\n    if (typeof props === 'boolean') return 0;\n    return props.offsetTop || 0;\n  };\n\n  const updateAffixHeaderOrFooter = () => {\n    if (!isAffixed.value && !isVirtualScroll.value) return;\n    const pos = tableContentRef.value?.getBoundingClientRect();\n    const headerRect = tableContentRef.value?.querySelector('thead')?.getBoundingClientRect();\n    const headerHeight = headerRect?.height || 0;\n    const footerRect = affixFooterRef.value?.getBoundingClientRect();\n    if ((props.headerAffixedTop || isVirtualScroll.value) && affixHeaderRef.value) {\n      const offsetTop = getOffsetTop(props.headerAffixProps || props.headerAffixedTop);\n      const footerHeight = footerRect?.height || 0;\n      let r = Math.abs(pos.top) < pos.height - headerHeight - offsetTop - footerHeight;\n      // 如果是虚拟滚动的表头，只要表头在可视区域内，一律永久显示（虚拟滚动表头 和 吸顶表头可能同时存在）\n      if (isVirtualScroll.value) {\n        r = pos.top > -1 * headerRect.height;\n      }\n      showAffixHeader.value = r;\n    }\n    // 底部内容吸底 和 底部滚动条吸底，不可能同时存在，二选一即可\n    if (props.footerAffixedBottom && affixFooterRef?.value) {\n      showAffixFooter.value = isAffixedBottomElementShow(footerRect, pos, headerHeight);\n    } else if (props.horizontalScrollAffixedBottom && horizontalScrollbarRef?.value) {\n      const horizontalScrollbarRect = horizontalScrollbarRef.value.getBoundingClientRect();\n      showAffixFooter.value = isAffixedBottomElementShow(horizontalScrollbarRect, pos, headerHeight);\n    }\n    if (props.paginationAffixedBottom && paginationRef.value) {\n      const pageRect = paginationRef.value.getBoundingClientRect();\n      showAffixPagination.value = isAffixedBottomElementShow(pageRect, pos, headerHeight);\n    }\n  };\n\n  const onDocumentScroll = () => {\n    updateAffixHeaderOrFooter();\n  };\n\n  const onFootScroll = () => {\n    onHorizontalScroll(affixFooterRef.value);\n  };\n\n  const onHeaderScroll = () => {\n    onHorizontalScroll(affixHeaderRef.value);\n  };\n\n  const horizontalScrollbarScroll = () => {\n    onHorizontalScroll(horizontalScrollbarRef.value);\n  };\n\n  const onTableContentScroll = () => {\n    onHorizontalScroll(tableContentRef.value);\n  };\n\n  const onFootMouseEnter = () => {\n    on(affixFooterRef.value, 'scroll', onFootScroll);\n  };\n\n  const onFootMouseLeave = () => {\n    off(affixFooterRef.value, 'scroll', onFootScroll);\n  };\n\n  const onHeaderMouseEnter = () => {\n    on(affixHeaderRef.value, 'scroll', onHeaderScroll);\n  };\n\n  const onHeaderMouseLeave = () => {\n    off(affixHeaderRef.value, 'scroll', onHeaderScroll);\n  };\n\n  const onScrollbarMouseEnter = () => {\n    on(horizontalScrollbarRef.value, 'scroll', horizontalScrollbarScroll);\n  };\n\n  const onScrollbarMouseLeave = () => {\n    off(horizontalScrollbarRef.value, 'scroll', horizontalScrollbarScroll);\n  };\n\n  const onTableContentMouseEnter = () => {\n    on(tableContentRef.value, 'scroll', onTableContentScroll);\n  };\n\n  const onTableContentMouseLeave = () => {\n    off(tableContentRef.value, 'scroll', onTableContentScroll);\n  };\n\n  const addHorizontalScrollListeners = () => {\n    if (affixHeaderRef.value) {\n      on(affixHeaderRef.value, 'mouseenter', onHeaderMouseEnter);\n      on(affixHeaderRef.value, 'mouseleave', onHeaderMouseLeave);\n    }\n\n    if (props.footerAffixedBottom && affixFooterRef.value) {\n      on(affixFooterRef.value, 'mouseenter', onFootMouseEnter);\n      on(affixFooterRef.value, 'mouseleave', onFootMouseLeave);\n    }\n\n    if (props.horizontalScrollAffixedBottom && horizontalScrollbarRef.value) {\n      on(horizontalScrollbarRef.value, 'mouseenter', onScrollbarMouseEnter);\n      on(horizontalScrollbarRef.value, 'mouseleave', onScrollbarMouseLeave);\n    }\n\n    if ((isAffixed.value || isVirtualScroll.value) && tableContentRef.value) {\n      on(tableContentRef.value, 'mouseenter', onTableContentMouseEnter);\n      on(tableContentRef.value, 'mouseleave', onTableContentMouseLeave);\n    }\n  };\n\n  const removeHorizontalScrollListeners = () => {\n    if (affixHeaderRef.value) {\n      off(affixHeaderRef.value, 'mouseenter', onHeaderMouseEnter);\n      off(affixHeaderRef.value, 'mouseleave', onHeaderMouseLeave);\n    }\n    if (affixFooterRef.value) {\n      off(affixFooterRef.value, 'mouseenter', onFootMouseEnter);\n      off(affixFooterRef.value, 'mouseleave', onFootMouseLeave);\n    }\n    if (tableContentRef.value) {\n      off(tableContentRef.value, 'mouseenter', onTableContentMouseEnter);\n      off(tableContentRef.value, 'mouseleave', onTableContentMouseLeave);\n    }\n    if (horizontalScrollbarRef.value) {\n      off(horizontalScrollbarRef.value, 'mouseenter', onScrollbarMouseEnter);\n      off(horizontalScrollbarRef.value, 'mouseleave', onScrollbarMouseLeave);\n    }\n  };\n\n  const addVerticalScrollListener = () => {\n    if (!isAffixed.value && !props.paginationAffixedBottom) return;\n    const timer = setTimeout(() => {\n      if (isAffixed.value || props.paginationAffixedBottom) {\n        on(document, 'scroll', onDocumentScroll);\n      } else {\n        off(document, 'scroll', onDocumentScroll);\n      }\n      clearTimeout(timer);\n    });\n  };\n\n  watch([affixHeaderRef, affixFooterRef, horizontalScrollbarRef, tableContentRef], () => {\n    addHorizontalScrollListeners();\n    onHorizontalScroll();\n    updateAffixHeaderOrFooter();\n  });\n\n  watch(isAffixed, addVerticalScrollListener);\n\n  watch(\n    () => [\n      props.data,\n      props.columns,\n      props.headerAffixedTop,\n      props.footerAffixedBottom,\n      props.horizontalScrollAffixedBottom,\n    ],\n    () => {\n      onHorizontalScroll();\n    },\n  );\n\n  onBeforeMount(() => {\n    off(document, 'scroll', onDocumentScroll);\n    removeHorizontalScrollListeners();\n  });\n\n  const setTableContentRef = (tableContent: HTMLDivElement) => {\n    tableContentRef.value = tableContent;\n    addVerticalScrollListener();\n  };\n\n  return {\n    showAffixHeader,\n    showAffixFooter,\n    showAffixPagination,\n    affixHeaderRef,\n    affixFooterRef,\n    horizontalScrollbarRef,\n    paginationRef,\n    onHorizontalScroll,\n    setTableContentRef,\n    updateAffixHeaderOrFooter,\n  };\n}\n"],"names":["useAffix","props","tableContentRef","ref","affixHeaderRef","affixFooterRef","horizontalScrollbarRef","paginationRef","showAffixHeader","showAffixFooter","showAffixPagination","isVirtualScroll","computed","scroll","type","threshold","data","length","isAffixed","headerAffixedTop","footerAffixedBottom","horizontalScrollAffixedBottom","lastScrollLeft","onHorizontalScroll","scrollElement","value","target","left","scrollLeft","toUpdateScrollElement","i","len","isAffixedBottomElementShow","elementRect","tableRect","headerHeight","top","height","getOffsetTop","offsetTop","updateAffixHeaderOrFooter","pos","getBoundingClientRect","headerRect","querySelector","footerRect","headerAffixProps","footerHeight","r","Math","abs","horizontalScrollbarRect","paginationAffixedBottom","pageRect","onDocumentScroll","onFootScroll","onHeaderScroll","horizontalScrollbarScroll","onTableContentScroll","onFootMouseEnter","on","onFootMouseLeave","off","onHeaderMouseEnter","onHeaderMouseLeave","onScrollbarMouseEnter","onScrollbarMouseLeave","onTableContentMouseEnter","onTableContentMouseLeave","addHorizontalScrollListeners","removeHorizontalScrollListeners","addVerticalScrollListener","timer","setTimeout","document","clearTimeout","watch","columns","onBeforeMount","setTableContentRef","tableContent"],"mappings":";;;;;;;;;;;;;;;;AAWA,SAAwBA,SAASC,KAAyB,EAAA;EACxD,IAAMC,kBAAkBC,OAAoB,EAAA,CAAA;EAE5C,IAAMC,iBAAiBD,OAAoB,EAAA,CAAA;EAE3C,IAAME,iBAAiBF,OAAoB,EAAA,CAAA;EAE3C,IAAMG,yBAAyBH,OAAoB,EAAA,CAAA;EAEnD,IAAMI,gBAAgBJ,OAAoB,EAAA,CAAA;AAEpC,EAAA,IAAAK,eAAA,GAAkBL,QAAI,IAAI,CAAA,CAAA;AAE1B,EAAA,IAAAM,eAAA,GAAkBN,QAAI,IAAI,CAAA,CAAA;AAE1B,EAAA,IAAAO,mBAAA,GAAsBP,QAAI,IAAI,CAAA,CAAA;EAEpC,IAAMQ,eAAkB,GAAAC,YAAA,CACtB,YAAA;IAAA,OAAMX,KAAA,CAAMY,MAAU,IAAAZ,KAAA,CAAMY,MAAO,CAAAC,IAAA,KAAS,SAAc,IAAA,CAAAb,KAAA,CAAMY,MAAO,CAAAE,SAAA,IAAa,GAAO,IAAAd,KAAA,CAAMe,IAAK,CAAAC,MAAA,CAAA;GACxG,CAAA,CAAA;EAEA,IAAMC,SAAY,GAAAN,YAAA,CAChB,YAAA;AAAA,IAAA,OAAM,CAAC,EAAEX,MAAMkB,gBAAoB,IAAAlB,KAAA,CAAMmB,uBAAuBnB,KAAM,CAAAoB,6BAAA,CAAA,CAAA;GACxE,CAAA,CAAA;EAEA,IAAIC,cAAiB,GAAA,CAAA,CAAA;AACf,EAAA,IAAAC,kBAAA,GAAqB,SAArBA,kBAAA,CAAsBC,aAAgC,EAAA;IAC1D,IAAI,CAACN,SAAA,CAAUO,KAAS,IAAA,CAACd,eAAgB,CAAAc,KAAA,EAAO,OAAA;IAChD,IAAIC,MAAS,GAAAF,aAAA,CAAA;AACT,IAAA,IAAA,CAACE,MAAU,IAAAxB,eAAA,CAAgBuB,KAAO,EAAA;AACnBH,MAAAA,cAAA,GAAA,CAAA,CAAA;MACjBI,MAAA,GAASxB,eAAgB,CAAAuB,KAAA,CAAA;AAC3B,KAAA;IACA,IAAI,CAACC,MAAA,EAAQ,OAAA;AACb,IAAA,IAAMC,OAAOD,MAAO,CAAAE,UAAA,CAAA;IAEpB,IAAIN,cAAmB,KAAAK,IAAA,EAAM,OAAA;AACZL,IAAAA,cAAA,GAAAK,IAAA,CAAA;AAEjB,IAAA,IAAME,qBAAwB,GAAA,CAC5B3B,eAAgB,CAAAuB,KAAA,EAChBrB,cAAe,CAAAqB,KAAA,EACfpB,cAAe,CAAAoB,KAAA,EACfnB,sBAAuB,CAAAmB,KAAA,CACzB,CAAA;AACA,IAAA,KAAA,IAASK,IAAI,CAAG,EAAAC,GAAA,GAAMF,sBAAsBZ,MAAQ,EAAAa,CAAA,GAAIC,KAAKD,CAAK,EAAA,EAAA;MAChE,IAAID,qBAAsB,CAAAC,CAAA,CAAA,IAAMN,aAAkB,KAAAK,qBAAA,CAAsBC,CAAI,CAAA,EAAA;AAC1ED,QAAAA,qBAAA,CAAsBC,GAAGF,UAAa,GAAAD,IAAA,CAAA;AACxC,OAAA;AACF,KAAA;GACF,CAAA;EAGA,IAAMK,0BAA6B,GAAA,SAA7BA,0BAA6B,CAACC,WAAsB,EAAAC,SAAA,EAAoBC,YAC5E,EAAA;AAAA,IAAA,OAAAD,SAAA,CAAUE,GAAM,GAAAD,YAAA,GAAeF,WAAY,CAAAG,GAAA,IAAOH,WAAY,CAAAG,GAAA,GAAMH,WAAY,CAAAI,MAAA,CAAA;AAAA,GAAA,CAAA;AAE5E,EAAA,IAAAC,YAAA,GAAe,SAAfA,YAAA,CAAgBrC,MAAgC,EAAA;AACpD,IAAA,IAAI,OAAOA,MAAU,KAAA,SAAA,EAAkB,OAAA,CAAA,CAAA;AACvC,IAAA,OAAOA,OAAMsC,SAAa,IAAA,CAAA,CAAA;GAC5B,CAAA;AAEA,EAAA,IAAMC,4BAA4B,SAA5BA,4BAAkC;AAAA,IAAA,IAAA,qBAAA,EAAA,sBAAA,EAAA,sBAAA,EAAA,qBAAA,CAAA;IACtC,IAAI,CAACtB,SAAA,CAAUO,KAAS,IAAA,CAACd,eAAgB,CAAAc,KAAA,EAAO,OAAA;IAC1C,IAAAgB,GAAA,4BAAMvC,eAAgB,CAAAuB,KAAA,MAAhB,IAAA,IAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,qBAAA,CAAuBiB,qBAAsB,EAAA,CAAA;AACzD,IAAA,IAAMC,uCAAazC,eAAgB,CAAAuB,KAAA,MAAhB,IAAA,IAAA,sBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,CAAA,sBAAA,GAAA,sBAAA,CAAuBmB,aAAc,CAAA,OAAO,OAA5C,IAAA,IAAA,sBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,sBAAA,CAA+CF,qBAAsB,EAAA,CAAA;IAClF,IAAAP,YAAA,GAAe,CAAAQ,uBAAAA,iCAAAA,WAAYN,MAAU,KAAA,CAAA,CAAA;IACrC,IAAAQ,UAAA,4BAAaxC,cAAe,CAAAoB,KAAA,MAAf,IAAA,IAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,qBAAA,CAAsBiB,qBAAsB,EAAA,CAAA;AAC/D,IAAA,IAAA,CAAKzC,KAAM,CAAAkB,gBAAA,IAAoBR,eAAgB,CAAAc,KAAA,KAAUrB,eAAeqB,KAAO,EAAA;MAC7E,IAAMc,SAAY,GAAAD,YAAA,CAAarC,KAAM,CAAA6C,gBAAA,IAAoB7C,MAAMkB,gBAAgB,CAAA,CAAA;MACzE,IAAA4B,YAAA,GAAe,CAAAF,uBAAAA,iCAAAA,WAAYR,MAAU,KAAA,CAAA,CAAA;AACvC,MAAA,IAAAW,CAAA,GAAIC,KAAKC,GAAI,CAAAT,GAAA,CAAIL,GAAG,CAAI,GAAAK,GAAA,CAAIJ,MAAS,GAAAF,YAAA,GAAeI,SAAY,GAAAQ,YAAA,CAAA;MAEpE,IAAIpC,gBAAgBc,KAAO,EAAA;QACrBuB,CAAA,GAAAP,GAAA,CAAIL,GAAM,GAAA,CAAA,CAAA,GAAKO,UAAW,CAAAN,MAAA,CAAA;AAChC,OAAA;MACA7B,eAAA,CAAgBiB,KAAQ,GAAAuB,CAAA,CAAA;AAC1B,KAAA;IAEI,IAAA/C,KAAA,CAAMmB,mBAAuB,IAAAf,cAAA,KAAAA,IAAAA,IAAAA,cAAA,KAAAA,KAAAA,CAAAA,IAAAA,cAAA,CAAgBoB,KAAO,EAAA;MACtDhB,eAAA,CAAgBgB,KAAQ,GAAAO,0BAAA,CAA2Ba,UAAY,EAAAJ,GAAA,EAAKN,YAAY,CAAA,CAAA;AAClF,KAAW,MAAA,IAAAlC,KAAA,CAAMoB,6BAAiC,IAAAf,sBAAA,KAAA,IAAA,IAAAA,sBAAA,KAAA,KAAA,CAAA,IAAAA,sBAAA,CAAwBmB,KAAO,EAAA;AACzE,MAAA,IAAA0B,uBAAA,GAA0B7C,sBAAuB,CAAAmB,KAAA,CAAMiB,qBAAsB,EAAA,CAAA;MACnFjC,eAAA,CAAgBgB,KAAQ,GAAAO,0BAAA,CAA2BmB,uBAAyB,EAAAV,GAAA,EAAKN,YAAY,CAAA,CAAA;AAC/F,KAAA;AACI,IAAA,IAAAlC,KAAA,CAAMmD,uBAA2B,IAAA7C,aAAA,CAAckB,KAAO,EAAA;AAClD,MAAA,IAAA4B,QAAA,GAAW9C,aAAc,CAAAkB,KAAA,CAAMiB,qBAAsB,EAAA,CAAA;MAC3DhC,mBAAA,CAAoBe,KAAQ,GAAAO,0BAAA,CAA2BqB,QAAU,EAAAZ,GAAA,EAAKN,YAAY,CAAA,CAAA;AACpF,KAAA;GACF,CAAA;AAEA,EAAA,IAAMmB,mBAAmB,SAAnBA,mBAAyB;AACHd,IAAAA,yBAAA,EAAA,CAAA;GAC5B,CAAA;AAEA,EAAA,IAAMe,eAAe,SAAfA,eAAqB;AACzBhC,IAAAA,kBAAA,CAAmBlB,eAAeoB,KAAK,CAAA,CAAA;GACzC,CAAA;AAEA,EAAA,IAAM+B,iBAAiB,SAAjBA,iBAAuB;AAC3BjC,IAAAA,kBAAA,CAAmBnB,eAAeqB,KAAK,CAAA,CAAA;GACzC,CAAA;AAEA,EAAA,IAAMgC,4BAA4B,SAA5BA,4BAAkC;AACtClC,IAAAA,kBAAA,CAAmBjB,uBAAuBmB,KAAK,CAAA,CAAA;GACjD,CAAA;AAEA,EAAA,IAAMiC,uBAAuB,SAAvBA,uBAA6B;AACjCnC,IAAAA,kBAAA,CAAmBrB,gBAAgBuB,KAAK,CAAA,CAAA;GAC1C,CAAA;AAEA,EAAA,IAAMkC,mBAAmB,SAAnBA,mBAAyB;IAC1BC,YAAA,CAAAvD,cAAA,CAAeoB,KAAO,EAAA,QAAA,EAAU8B,YAAY,CAAA,CAAA;GACjD,CAAA;AAEA,EAAA,IAAMM,mBAAmB,SAAnBA,mBAAyB;IACzBC,aAAA,CAAAzD,cAAA,CAAeoB,KAAO,EAAA,QAAA,EAAU8B,YAAY,CAAA,CAAA;GAClD,CAAA;AAEA,EAAA,IAAMQ,qBAAqB,SAArBA,qBAA2B;IAC5BH,YAAA,CAAAxD,cAAA,CAAeqB,KAAO,EAAA,QAAA,EAAU+B,cAAc,CAAA,CAAA;GACnD,CAAA;AAEA,EAAA,IAAMQ,qBAAqB,SAArBA,qBAA2B;IAC3BF,aAAA,CAAA1D,cAAA,CAAeqB,KAAO,EAAA,QAAA,EAAU+B,cAAc,CAAA,CAAA;GACpD,CAAA;AAEA,EAAA,IAAMS,wBAAwB,SAAxBA,wBAA8B;IAC/BL,YAAA,CAAAtD,sBAAA,CAAuBmB,KAAO,EAAA,QAAA,EAAUgC,yBAAyB,CAAA,CAAA;GACtE,CAAA;AAEA,EAAA,IAAMS,wBAAwB,SAAxBA,wBAA8B;IAC9BJ,aAAA,CAAAxD,sBAAA,CAAuBmB,KAAO,EAAA,QAAA,EAAUgC,yBAAyB,CAAA,CAAA;GACvE,CAAA;AAEA,EAAA,IAAMU,2BAA2B,SAA3BA,2BAAiC;IAClCP,YAAA,CAAA1D,eAAA,CAAgBuB,KAAO,EAAA,QAAA,EAAUiC,oBAAoB,CAAA,CAAA;GAC1D,CAAA;AAEA,EAAA,IAAMU,2BAA2B,SAA3BA,2BAAiC;IACjCN,aAAA,CAAA5D,eAAA,CAAgBuB,KAAO,EAAA,QAAA,EAAUiC,oBAAoB,CAAA,CAAA;GAC3D,CAAA;AAEA,EAAA,IAAMW,+BAA+B,SAA/BA,+BAAqC;IACzC,IAAIjE,eAAeqB,KAAO,EAAA;MACrBmC,YAAA,CAAAxD,cAAA,CAAeqB,KAAO,EAAA,YAAA,EAAcsC,kBAAkB,CAAA,CAAA;MACtDH,YAAA,CAAAxD,cAAA,CAAeqB,KAAO,EAAA,YAAA,EAAcuC,kBAAkB,CAAA,CAAA;AAC3D,KAAA;AAEI,IAAA,IAAA/D,KAAA,CAAMmB,mBAAuB,IAAAf,cAAA,CAAeoB,KAAO,EAAA;MAClDmC,YAAA,CAAAvD,cAAA,CAAeoB,KAAO,EAAA,YAAA,EAAckC,gBAAgB,CAAA,CAAA;MACpDC,YAAA,CAAAvD,cAAA,CAAeoB,KAAO,EAAA,YAAA,EAAcoC,gBAAgB,CAAA,CAAA;AACzD,KAAA;AAEI,IAAA,IAAA5D,KAAA,CAAMoB,6BAAiC,IAAAf,sBAAA,CAAuBmB,KAAO,EAAA;MACpEmC,YAAA,CAAAtD,sBAAA,CAAuBmB,KAAO,EAAA,YAAA,EAAcwC,qBAAqB,CAAA,CAAA;MACjEL,YAAA,CAAAtD,sBAAA,CAAuBmB,KAAO,EAAA,YAAA,EAAcyC,qBAAqB,CAAA,CAAA;AACtE,KAAA;AAEA,IAAA,IAAA,CAAKhD,SAAU,CAAAO,KAAA,IAASd,eAAgB,CAAAc,KAAA,KAAUvB,gBAAgBuB,KAAO,EAAA;MACpEmC,YAAA,CAAA1D,eAAA,CAAgBuB,KAAO,EAAA,YAAA,EAAc0C,wBAAwB,CAAA,CAAA;MAC7DP,YAAA,CAAA1D,eAAA,CAAgBuB,KAAO,EAAA,YAAA,EAAc2C,wBAAwB,CAAA,CAAA;AAClE,KAAA;GACF,CAAA;AAEA,EAAA,IAAME,kCAAkC,SAAlCA,kCAAwC;IAC5C,IAAIlE,eAAeqB,KAAO,EAAA;MACpBqC,aAAA,CAAA1D,cAAA,CAAeqB,KAAO,EAAA,YAAA,EAAcsC,kBAAkB,CAAA,CAAA;MACtDD,aAAA,CAAA1D,cAAA,CAAeqB,KAAO,EAAA,YAAA,EAAcuC,kBAAkB,CAAA,CAAA;AAC5D,KAAA;IACA,IAAI3D,eAAeoB,KAAO,EAAA;MACpBqC,aAAA,CAAAzD,cAAA,CAAeoB,KAAO,EAAA,YAAA,EAAckC,gBAAgB,CAAA,CAAA;MACpDG,aAAA,CAAAzD,cAAA,CAAeoB,KAAO,EAAA,YAAA,EAAcoC,gBAAgB,CAAA,CAAA;AAC1D,KAAA;IACA,IAAI3D,gBAAgBuB,KAAO,EAAA;MACrBqC,aAAA,CAAA5D,eAAA,CAAgBuB,KAAO,EAAA,YAAA,EAAc0C,wBAAwB,CAAA,CAAA;MAC7DL,aAAA,CAAA5D,eAAA,CAAgBuB,KAAO,EAAA,YAAA,EAAc2C,wBAAwB,CAAA,CAAA;AACnE,KAAA;IACA,IAAI9D,uBAAuBmB,KAAO,EAAA;MAC5BqC,aAAA,CAAAxD,sBAAA,CAAuBmB,KAAO,EAAA,YAAA,EAAcwC,qBAAqB,CAAA,CAAA;MACjEH,aAAA,CAAAxD,sBAAA,CAAuBmB,KAAO,EAAA,YAAA,EAAcyC,qBAAqB,CAAA,CAAA;AACvE,KAAA;GACF,CAAA;AAEA,EAAA,IAAMK,4BAA4B,SAA5BA,4BAAkC;IACtC,IAAI,CAACrD,SAAA,CAAUO,KAAS,IAAA,CAACxB,KAAM,CAAAmD,uBAAA,EAAyB,OAAA;AAClD,IAAA,IAAAoB,KAAA,GAAQC,WAAW,YAAM;AACzB,MAAA,IAAAvD,SAAA,CAAUO,KAAS,IAAAxB,KAAA,CAAMmD,uBAAyB,EAAA;AACjDQ,QAAAA,YAAA,CAAAc,QAAA,EAAU,UAAUpB,gBAAgB,CAAA,CAAA;AACzC,OAAO,MAAA;AACDQ,QAAAA,aAAA,CAAAY,QAAA,EAAU,UAAUpB,gBAAgB,CAAA,CAAA;AAC1C,OAAA;MACAqB,YAAA,CAAaH,KAAK,CAAA,CAAA;AACpB,KAAC,CAAA,CAAA;GACH,CAAA;EAEAI,SAAA,CAAM,CAACxE,cAAgB,EAAAC,cAAA,EAAgBC,sBAAwB,EAAAJ,eAAe,GAAG,YAAM;AACxDmE,IAAAA,4BAAA,EAAA,CAAA;AACV9C,IAAAA,kBAAA,EAAA,CAAA;AACOiB,IAAAA,yBAAA,EAAA,CAAA;AAC5B,GAAC,CAAA,CAAA;AAEDoC,EAAAA,SAAA,CAAM1D,WAAWqD,yBAAyB,CAAA,CAAA;AAE1CK,EAAAA,SAAA,CACE,YAAA;IAAA,OAAM,CACJ3E,KAAM,CAAAe,IAAA,EACNf,KAAM,CAAA4E,OAAA,EACN5E,KAAM,CAAAkB,gBAAA,EACNlB,KAAM,CAAAmB,mBAAA,EACNnB,KAAM,CAAAoB,6BAAA,CACR,CAAA;AAAA,GAAA,EACA,YAAM;AACeE,IAAAA,kBAAA,EAAA,CAAA;AACrB,GAAA,CACF,CAAA;AAEAuD,EAAAA,iBAAA,CAAc,YAAM;AACdhB,IAAAA,aAAA,CAAAY,QAAA,EAAU,UAAUpB,gBAAgB,CAAA,CAAA;AACRgB,IAAAA,+BAAA,EAAA,CAAA;AAClC,GAAC,CAAA,CAAA;AAEK,EAAA,IAAAS,kBAAA,GAAqB,SAArBA,kBAAA,CAAsBC,YAAiC,EAAA;IAC3D9E,eAAA,CAAgBuB,KAAQ,GAAAuD,YAAA,CAAA;AACET,IAAAA,yBAAA,EAAA,CAAA;GAC5B,CAAA;EAEO,OAAA;AACL/D,IAAAA,eAAA,EAAAA,eAAA;AACAC,IAAAA,eAAA,EAAAA,eAAA;AACAC,IAAAA,mBAAA,EAAAA,mBAAA;AACAN,IAAAA,cAAA,EAAAA,cAAA;AACAC,IAAAA,cAAA,EAAAA,cAAA;AACAC,IAAAA,sBAAA,EAAAA,sBAAA;AACAC,IAAAA,aAAA,EAAAA,aAAA;AACAgB,IAAAA,kBAAA,EAAAA,kBAAA;AACAwD,IAAAA,kBAAA,EAAAA,kBAAA;AACAvC,IAAAA,yBAAA,EAAAA,yBAAAA;GACF,CAAA;AACF;;;;"}