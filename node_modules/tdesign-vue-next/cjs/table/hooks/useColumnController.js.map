{"version":3,"file":"useColumnController.js","sources":["../../../src/table/hooks/useColumnController.tsx"],"sourcesContent":["/**\n * 自定义显示列控制器，即列配置\n */\nimport { computed, ref, SetupContext, toRefs, watch } from 'vue';\nimport { SettingIcon as TdSettingIcon } from 'tdesign-icons-vue-next';\n\nimport intersection from 'lodash/intersection';\nimport Checkbox, {\n  CheckboxGroup,\n  CheckboxGroupValue,\n  CheckboxOptionObj,\n  CheckboxGroupChangeContext,\n} from '../../checkbox';\nimport { DialogPlugin } from '../../dialog/plugin';\nimport { renderTitle } from './useTableHeader';\nimport { PrimaryTableCol, TdPrimaryTableProps } from '../type';\nimport { useConfig } from '../../hooks/useConfig';\nimport { useGlobalIcon } from '../../hooks/useGlobalIcon';\nimport useDefaultValue from '../../hooks/useDefaultValue';\nimport { getCurrentRowByKey } from '../utils';\nimport { DialogInstance } from '../../dialog';\nimport TButton from '../../button';\n\nexport function getColumnKeys(columns: PrimaryTableCol[], keys = new Set<string>()) {\n  for (let i = 0, len = columns.length; i < len; i++) {\n    const col = columns[i];\n    col.colKey && keys.add(col.colKey);\n    if (col.children?.length) {\n      getColumnKeys(col.children, keys);\n    }\n  }\n  return keys;\n}\n\nexport default function useColumnController(props: TdPrimaryTableProps, context: SetupContext) {\n  const { classPrefix, globalConfig } = useConfig('table');\n  const { SettingIcon } = useGlobalIcon({ SettingIcon: TdSettingIcon });\n  const { columns, columnController, displayColumns, columnControllerVisible } = toRefs(props);\n  const dialogInstance = ref<DialogInstance>(null);\n\n  const enabledColKeys = computed(() => {\n    const arr = (columnController.value?.fields || [...getColumnKeys(columns.value)] || []).filter((v) => v);\n    return new Set(arr);\n  });\n\n  const keys = [...getColumnKeys(columns.value)];\n\n  // 确认后的列配置\n  const [tDisplayColumns, setTDisplayColumns] = useDefaultValue(\n    displayColumns,\n    props.defaultDisplayColumns || keys,\n    props.onDisplayColumnsChange,\n    'displayColumns',\n  );\n  // 弹框内的多选\n  const columnCheckboxKeys = ref<CheckboxGroupValue>(displayColumns.value || props.defaultDisplayColumns || keys);\n\n  const checkboxOptions = computed<CheckboxOptionObj[]>(() => getCheckboxOptions(columns.value));\n\n  const intersectionChecked = computed(() => intersection(columnCheckboxKeys.value, [...enabledColKeys.value]));\n\n  watch([displayColumns], ([val]) => {\n    columnCheckboxKeys.value = val || props.defaultDisplayColumns || keys;\n  });\n\n  function getCheckboxOptions(columns: PrimaryTableCol[], arr: CheckboxOptionObj[] = []) {\n    // 减少循环次数\n    for (let i = 0, len = columns.length; i < len; i++) {\n      const item = columns[i];\n      if (item.colKey) {\n        arr.push({\n          label: () => renderTitle(context.slots, item, i),\n          value: item.colKey,\n          disabled: !enabledColKeys.value.has(item.colKey),\n        });\n      }\n      if (item.children?.length) {\n        getCheckboxOptions(item.children, arr);\n      }\n    }\n    return arr;\n  }\n\n  const handleCheckChange = (val: CheckboxGroupValue, ctx: CheckboxGroupChangeContext) => {\n    columnCheckboxKeys.value = val;\n    const params = {\n      columns: val,\n      type: ctx.type,\n      currentColumn: getCurrentRowByKey(columns.value, String(ctx.current)),\n      e: ctx.e,\n    };\n    props.onColumnChange?.(params);\n  };\n\n  const handleClickAllShowColumns = (checked: boolean, ctx: { e: Event }) => {\n    if (checked) {\n      const newData = checkboxOptions.value?.map((t) => t.value) || [];\n      columnCheckboxKeys.value = newData;\n      props.onColumnChange?.({ type: 'check', columns: newData, e: ctx.e });\n    } else {\n      const disabledColKeys = checkboxOptions.value.filter((t) => t.disabled).map((t) => t.value);\n      columnCheckboxKeys.value = disabledColKeys;\n      props.onColumnChange?.({ type: 'uncheck', columns: disabledColKeys, e: ctx.e });\n    }\n  };\n\n  const handleToggleColumnController = () => {\n    dialogInstance.value = DialogPlugin.confirm({\n      header: globalConfig.value.columnConfigTitleText,\n      body: () => {\n        const widthMode = columnController.value?.displayType === 'fixed-width' ? 'fixed' : 'auto';\n        const checkedLength = intersectionChecked.value.length;\n        const isCheckedAll = checkedLength === enabledColKeys.value.size;\n        const isIndeterminate = checkedLength > 0 && checkedLength < enabledColKeys.value.size;\n        const defaultNode = (\n          <div\n            class={[\n              `${classPrefix.value}-table__column-controller`,\n              `${classPrefix.value}-table__column-controller--${widthMode}`,\n            ]}\n          >\n            <div class={`${classPrefix.value}-table__column-controller-body`}>\n              {/* 请选择需要在表格中显示的数据列 */}\n              <p class={`${classPrefix.value}-table__column-controller-desc`}>\n                {globalConfig.value.columnConfigDescriptionText}\n              </p>\n              <div class={`${classPrefix.value}-table__column-controller-block`}>\n                <Checkbox indeterminate={isIndeterminate} checked={isCheckedAll} onChange={handleClickAllShowColumns}>\n                  {globalConfig.value.selectAllText}\n                </Checkbox>\n              </div>\n              <div class={`${classPrefix.value}-table__column-controller-block`}>\n                <CheckboxGroup\n                  options={checkboxOptions.value}\n                  {...(columnController.value?.checkboxProps || {})}\n                  value={columnCheckboxKeys.value}\n                  onChange={handleCheckChange}\n                />\n              </div>\n            </div>\n          </div>\n        );\n        return defaultNode;\n      },\n      confirmBtn: globalConfig.value.confirmText,\n      cancelBtn: globalConfig.value.cancelText,\n      width: 612,\n      onConfirm: () => {\n        setTDisplayColumns([...columnCheckboxKeys.value]);\n        // 此处逻辑不要随意改动，涉及到 内置列配置按钮 和 不包含列配置按钮等场景\n        if (columnControllerVisible.value === undefined) {\n          dialogInstance.value.hide();\n        } else {\n          props.onColumnControllerVisibleChange?.(false, { trigger: 'cancel' });\n          context.emit('update:columnControllerVisible', false);\n        }\n      },\n      onClose: () => {\n        // 此处逻辑不要随意改动，涉及到 内置列配置按钮 和 不包含列配置按钮等场景\n        if (columnControllerVisible.value === undefined) {\n          dialogInstance.value.hide();\n        } else {\n          props.onColumnControllerVisibleChange?.(false, { trigger: 'confirm' });\n          context.emit('update:columnControllerVisible', false);\n        }\n      },\n      ...(columnController.value?.dialogProps || {}),\n    });\n  };\n\n  // columnControllerVisible 一般应用于不包含列配置按钮的场景，有外部直接控制弹框的显示或隐藏\n  watch(\n    [columnControllerVisible],\n    ([visible]) => {\n      if (visible === undefined) return;\n      if (dialogInstance.value) {\n        visible ? dialogInstance.value.show() : dialogInstance.value.hide();\n      } else {\n        visible && handleToggleColumnController();\n      }\n    },\n    { immediate: true },\n  );\n\n  const renderColumnController = () => {\n    const isColumnController = !!(columnController.value && Object.keys(columnController.value).length);\n    const placement = isColumnController ? columnController.value.placement || 'top-right' : '';\n    if (isColumnController && columnController.value.hideTriggerButton) return null;\n    const classes = [\n      `${classPrefix.value}-table__column-controller-trigger`,\n      { [`${classPrefix.value}-align-${placement}`]: !!placement },\n    ];\n    return (\n      <div class={classes}>\n        <TButton\n          theme=\"default\"\n          variant=\"outline\"\n          onClick={handleToggleColumnController}\n          content={globalConfig.value.columnConfigButtonText}\n          v-slots={{\n            icon: () => <SettingIcon />,\n          }}\n          {...props.columnController?.buttonProps}\n        ></TButton>\n      </div>\n    );\n  };\n\n  return {\n    tDisplayColumns,\n    columnCheckboxKeys,\n    checkboxOptions,\n    renderColumnController,\n  };\n}\n"],"names":["getColumnKeys","columns","keys","Set","i","len","length","col","colKey","add","children","useColumnController","props","context","useConfig","classPrefix","globalConfig","useGlobalIcon","SettingIcon","TdSettingIcon","toRefs","columnController","displayColumns","columnControllerVisible","dialogInstance","ref","enabledColKeys","computed","arr","value","fields","_toConsumableArray","filter","v","useDefaultValue","defaultDisplayColumns","onDisplayColumnsChange","_slicedToArray","tDisplayColumns","setTDisplayColumns","columnCheckboxKeys","checkboxOptions","getCheckboxOptions","intersectionChecked","intersection","watch","val","item","push","label","renderTitle","slots","disabled","has","handleCheckChange","ctx","params","type","currentColumn","getCurrentRowByKey","String","current","e","onColumnChange","handleClickAllShowColumns","checked","newData","map","t","disabledColKeys","handleToggleColumnController","DialogPlugin","confirm","header","columnConfigTitleText","body","widthMode","displayType","checkedLength","isCheckedAll","size","isIndeterminate","defaultNode","_createVNode","columnConfigDescriptionText","Checkbox","selectAllText","CheckboxGroup","_mergeProps","checkboxProps","confirmBtn","confirmText","cancelBtn","cancelText","width","onConfirm","hide","onColumnControllerVisibleChange","trigger","emit","onClose","dialogProps","visible","show","immediate","renderColumnController","isColumnController","Object","placement","hideTriggerButton","classes","TButton","columnConfigButtonText","buttonProps","icon"],"mappings":"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"}