{"version":3,"file":"message.js","sources":["../../src/message/message.tsx"],"sourcesContent":["import { defineComponent, h, onBeforeMount, onMounted, computed, ref } from 'vue';\nimport {\n  InfoCircleFilledIcon as TdInfoCircleFilledIcon,\n  CheckCircleFilledIcon as TdCheckCircleFilledIcon,\n  ErrorCircleFilledIcon as TdErrorCircleFilledIcon,\n  HelpCircleFilledIcon as TdHelpCircleFilledIcon,\n  CloseIcon as TdCloseIcon,\n} from 'tdesign-icons-vue-next';\n\nimport TLoading from '../loading';\nimport { THEME_LIST } from './const';\nimport props from './props';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { fadeIn, fadeOut } from './animation';\nimport { useTNodeJSX, useContent } from '../hooks/tnode';\n\nexport default defineComponent({\n  name: 'TMessage',\n  props: {\n    ...props,\n    placement: String, // just for animation\n  },\n  setup(props, { slots, expose }) {\n    const COMPONENT_NAME = usePrefixClass('message');\n    const { InfoCircleFilledIcon, CheckCircleFilledIcon, ErrorCircleFilledIcon, HelpCircleFilledIcon, CloseIcon } =\n      useGlobalIcon({\n        InfoCircleFilledIcon: TdInfoCircleFilledIcon,\n        CheckCircleFilledIcon: TdCheckCircleFilledIcon,\n        ErrorCircleFilledIcon: TdErrorCircleFilledIcon,\n        HelpCircleFilledIcon: TdHelpCircleFilledIcon,\n        CloseIcon: TdCloseIcon,\n      });\n    const classPrefix = usePrefixClass();\n\n    const renderTNode = useTNodeJSX();\n    const renderContent = useContent();\n\n    const msgRef = ref(null);\n    const timer = ref(null);\n\n    const classes = computed(() => {\n      const status = {};\n      THEME_LIST.forEach((t) => (status[`${classPrefix.value}-is-${t}`] = props.theme === t));\n      return [\n        COMPONENT_NAME.value,\n        status,\n        {\n          [`${classPrefix.value}-is-closable`]: props.closeBtn || slots.closeBtn,\n        },\n      ];\n    });\n\n    const close = (e?: MouseEvent) => {\n      props.onCloseBtnClick?.({ e });\n    };\n\n    const clearTimer = () => {\n      props.duration && clearTimeout(timer.value);\n    };\n\n    const setTimer = () => {\n      if (!props.duration) {\n        return;\n      }\n      timer.value = Number(\n        setTimeout(() => {\n          clearTimer();\n          const msgDom = msgRef.value as HTMLElement;\n          fadeOut(msgDom, props.placement, () => {\n            props.onDurationEnd?.();\n          });\n        }, props.duration),\n      );\n    };\n\n    const renderClose = () => {\n      const defaultClose = <CloseIcon />;\n      return (\n        <span class={`${COMPONENT_NAME.value}__close`} onClick={close}>\n          {renderTNode('closeBtn', defaultClose)}\n        </span>\n      );\n    };\n\n    const renderIcon = () => {\n      if (props.icon === false) return;\n      if (typeof props.icon === 'function') return props.icon(h);\n      if (slots.icon) {\n        return slots.icon(null);\n      }\n      const Icon = {\n        info: InfoCircleFilledIcon,\n        success: CheckCircleFilledIcon,\n        warning: ErrorCircleFilledIcon,\n        error: ErrorCircleFilledIcon,\n        question: HelpCircleFilledIcon,\n        loading: TLoading,\n      }[props.theme];\n      return <Icon />;\n    };\n\n    onBeforeMount(() => {\n      props.duration && setTimer();\n    });\n\n    onMounted(() => {\n      const msgDom = msgRef.value;\n      fadeIn(msgDom, props.placement);\n    });\n\n    expose({ close });\n\n    return () => (\n      <div ref={msgRef} class={classes.value} onMouseenter={clearTimer} onMouseleave={setTimer}>\n        {renderIcon()}\n        {renderContent('content', 'default')}\n        {renderClose()}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","placement","String","setup","slots","expose","COMPONENT_NAME","usePrefixClass","useGlobalIcon","InfoCircleFilledIcon","TdInfoCircleFilledIcon","CheckCircleFilledIcon","TdCheckCircleFilledIcon","ErrorCircleFilledIcon","TdErrorCircleFilledIcon","HelpCircleFilledIcon","TdHelpCircleFilledIcon","CloseIcon","TdCloseIcon","classPrefix","renderTNode","useTNodeJSX","renderContent","useContent","msgRef","ref","timer","classes","computed","status","THEME_LIST","forEach","t","value","theme","closeBtn","close","e","onCloseBtnClick","clearTimer","duration","clearTimeout","setTimer","Number","setTimeout","msgDom","fadeOut","onDurationEnd","renderClose","defaultClose","_createVNode","renderIcon","icon","h","Icon","info","success","warning","error","question","loading","TLoading","onBeforeMount","onMounted","fadeIn"],"mappings":"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"}