{"version":3,"file":"notification.js","sources":["../../src/notification/notification.tsx"],"sourcesContent":["import { defineComponent, h, onBeforeMount, onMounted, ref } from 'vue';\nimport {\n  InfoCircleFilledIcon as TdInfoCircleFilledIcon,\n  CheckCircleFilledIcon as TdCheckCircleFilledIcon,\n  CloseIcon as TdCloseIcon,\n} from 'tdesign-icons-vue-next';\nimport isFunction from 'lodash/isFunction';\n\nimport { useTNodeJSX, useContent } from '../hooks/tnode';\nimport props from './props';\nimport { useConfig, usePrefixClass } from '../hooks/useConfig';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { fadeIn, fadeOut } from './animate';\n\nexport default defineComponent({\n  name: 'TNotification',\n  props: {\n    ...props,\n    placement: String, // just for animation\n  },\n  setup(props, { slots, expose }) {\n    const COMPONENT_NAME = usePrefixClass('notification');\n    const { classPrefix } = useConfig('classPrefix');\n    const { InfoCircleFilledIcon, CheckCircleFilledIcon, CloseIcon } = useGlobalIcon({\n      InfoCircleFilledIcon: TdInfoCircleFilledIcon,\n      CheckCircleFilledIcon: TdCheckCircleFilledIcon,\n      CloseIcon: TdCloseIcon,\n    });\n    const renderTNode = useTNodeJSX();\n    const renderContent = useContent();\n    const timer = ref(null);\n    const notificationRef = ref(null);\n\n    const close = (e?: MouseEvent) => {\n      const dom = notificationRef.value as HTMLElement;\n      fadeOut(dom, props.placement, () => {\n        props.onCloseBtnClick?.({ e });\n      });\n    };\n\n    const renderIcon = () => {\n      let iconContent;\n      if (props.icon === false) return null;\n      if (isFunction(props.icon)) {\n        iconContent = props.icon(h);\n      } else if (slots.icon) {\n        iconContent = slots.icon(null);\n      } else if (props.theme) {\n        const iconType =\n          props.theme === 'success' ? (\n            <CheckCircleFilledIcon class={`${classPrefix.value}-is-${props.theme}`} />\n          ) : (\n            <InfoCircleFilledIcon class={`${classPrefix.value}-is-${props.theme}`} />\n          );\n        iconContent = <div class={`t-notification__icon`}>{iconType}</div>;\n      }\n      return iconContent;\n    };\n\n    const renderClose = () => {\n      const defaultClose = <CloseIcon />;\n      return (\n        <span class={`${classPrefix.value}-message__close`} onClick={close}>\n          {renderTNode('closeBtn', defaultClose)}\n        </span>\n      );\n    };\n\n    const renderMainContent = () => {\n      return <div class={`${COMPONENT_NAME.value}__content`}>{renderContent('default', 'content')}</div>;\n    };\n\n    const clearTimer = () => {\n      props.duration && clearTimeout(timer.value);\n    };\n\n    const setTimer = () => {\n      if (!props.duration) {\n        return;\n      }\n      timer.value = Number(\n        setTimeout(() => {\n          clearTimer();\n          const dom = notificationRef.value as HTMLElement;\n          fadeOut(dom, props.placement, () => {\n            props.onDurationEnd?.();\n          });\n        }, props.duration),\n      );\n    };\n\n    onBeforeMount(() => {\n      props.duration && setTimer();\n    });\n\n    onMounted(() => {\n      const dom = notificationRef.value;\n      fadeIn(dom, props.placement);\n    });\n\n    expose({ close });\n    return () => (\n      <div ref={notificationRef} class={`${COMPONENT_NAME.value}`} onMouseenter={clearTimer} onMouseleave={setTimer}>\n        {renderIcon()}\n        <div class={`${COMPONENT_NAME.value}__main`}>\n          <div class={`${COMPONENT_NAME.value}__title__wrap`}>\n            <span class={`${COMPONENT_NAME.value}__title`}>{renderTNode('title')}</span>\n            {renderClose()}\n          </div>\n          {renderMainContent()}\n          {renderTNode('footer')}\n        </div>\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","placement","String","setup","slots","expose","COMPONENT_NAME","usePrefixClass","useConfig","classPrefix","useGlobalIcon","InfoCircleFilledIcon","TdInfoCircleFilledIcon","CheckCircleFilledIcon","TdCheckCircleFilledIcon","CloseIcon","TdCloseIcon","renderTNode","useTNodeJSX","renderContent","useContent","timer","ref","notificationRef","close","e","dom","value","fadeOut","onCloseBtnClick","renderIcon","iconContent","icon","isFunction","h","theme","iconType","_createVNode","renderClose","defaultClose","renderMainContent","clearTimer","duration","clearTimeout","setTimer","Number","setTimeout","onDurationEnd","onBeforeMount","onMounted","fadeIn"],"mappings":"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"}