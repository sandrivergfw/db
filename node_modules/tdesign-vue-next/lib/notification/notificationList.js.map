{"version":3,"file":"notificationList.js","sources":["../../src/notification/notificationList.tsx"],"sourcesContent":["import { defineComponent, ref, computed, Ref, CSSProperties } from 'vue';\nimport Notification from './notification';\nimport { TdNotificationProps, NotificationOptions } from './type';\nimport { DEFAULT_Z_INDEX, PLACEMENT_OFFSET, DISTANCE } from './const';\nimport { usePrefixClass } from '../hooks/useConfig';\n\nexport default defineComponent({\n  props: {\n    placement: {\n      type: String,\n      default: 'top-right',\n      validator(v: string): boolean {\n        return ['top-left', 'top-right', 'bottom-left', 'bottom-right'].indexOf(v) > -1;\n      },\n    },\n  },\n  setup(props, { expose }) {\n    const COMPONENT_NAME = usePrefixClass('notification-list');\n\n    const { placement } = props as NotificationOptions;\n\n    const list: Ref<NotificationOptions[]> = ref([]);\n    const notificationList = ref([]);\n\n    const styles = computed(() => ({\n      zIndex: DEFAULT_Z_INDEX,\n      ...PLACEMENT_OFFSET[placement],\n    }));\n\n    const add = (options: TdNotificationProps): number => {\n      list.value.push(options);\n      return list.value.length - 1;\n    };\n\n    const remove = (index: number) => {\n      list.value.splice(index, 1);\n    };\n\n    const removeAll = () => {\n      list.value = [];\n    };\n\n    const getOffset = (val: string | number) => {\n      if (!val) return;\n      return isNaN(Number(val)) ? val : `${val}px`;\n    };\n\n    const notificationStyles = (item: { offset: NotificationOptions['offset']; zIndex: number }) => {\n      const styles: CSSProperties = {\n        marginBottom: DISTANCE,\n      };\n      if (item.offset) {\n        styles.position = 'relative';\n        styles.left = getOffset(item.offset[0]);\n        styles.top = getOffset(item.offset[1]);\n      }\n      if (item.zIndex) styles['z-index'] = item.zIndex;\n      return styles;\n    };\n\n    const getProps = (index: number, item: NotificationOptions) => {\n      return {\n        ...item,\n        onCloseBtnClick: (e: any) => {\n          if (item.onCloseBtnClick) {\n            item.onCloseBtnClick(e);\n          }\n          return remove(index);\n        },\n        onDurationEnd: () => {\n          if (item.onDurationEnd) {\n            item.onDurationEnd();\n          }\n          return remove(index);\n        },\n      };\n    };\n\n    const addChild = (el: Element) => {\n      if (el) {\n        notificationList.value.push(el);\n      }\n    };\n    expose({ add, remove, removeAll, list, notificationList });\n\n    return () => {\n      if (!list.value.length) return;\n\n      return (\n        <div class={`${COMPONENT_NAME.value}__show`} style={styles.value}>\n          {list.value.map((item: { offset: NotificationOptions['offset']; zIndex: number; id: number }, index) => (\n            <Notification ref={addChild} key={item.id} style={notificationStyles(item)} {...getProps(index, item)} />\n          ))}\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","props","placement","type","String","validator","v","indexOf","setup","expose","COMPONENT_NAME","usePrefixClass","list","ref","notificationList","styles","computed","zIndex","DEFAULT_Z_INDEX","PLACEMENT_OFFSET","add","options","value","push","length","remove","index","splice","removeAll","getOffset","val","isNaN","Number","notificationStyles","item","marginBottom","DISTANCE","offset","position","left","top","getProps","onCloseBtnClick","e","onDurationEnd","addChild","el","_createVNode","map","Notification","_mergeProps","id"],"mappings":"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"}