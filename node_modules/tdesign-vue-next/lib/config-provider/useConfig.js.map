{"version":3,"file":"useConfig.js","sources":["../../src/config-provider/useConfig.tsx"],"sourcesContent":["import { computed, h, inject } from 'vue';\nimport _mergeWith from 'lodash/mergeWith';\nimport { defaultGlobalConfig, configProviderInjectKey } from './context';\nimport { GlobalConfigProvider } from './type';\n\nexport * from './type';\n\n/**\n * component globalConfig\n * @param componentName\n * @returns {t, globalConfig}\n * useConfig('pagination')\n */\nexport function useConfig<T extends keyof GlobalConfigProvider>(componentName?: T) {\n  const injectGlobalConfig = inject(configProviderInjectKey, null);\n  const mergedGlobalConfig = computed(() => injectGlobalConfig?.value || defaultGlobalConfig);\n  const globalConfig = computed(() => mergedGlobalConfig.value[componentName]);\n\n  const classPrefix = computed(() => {\n    return mergedGlobalConfig.value.classPrefix;\n  });\n\n  // 处理正则表达式\n  const t = function <T>(pattern: T, ...args: any[]) {\n    const [data] = args;\n    if (typeof pattern === 'string') {\n      if (!data) return pattern;\n      const regular = /\\{\\s*([\\w-]+)\\s*\\}/g;\n      const translated = pattern.replace(regular, (match, key) => {\n        if (data) {\n          return String(data[key]);\n        }\n        return '';\n      });\n      return translated;\n    }\n    if (typeof pattern === 'function') {\n      // 重要：组件的渲染必须存在参数 h，不能移除\n      if (!args.length) return pattern(h);\n      return pattern(...args);\n    }\n    return '';\n  };\n\n  return {\n    t,\n    global: globalConfig,\n    globalConfig,\n    classPrefix,\n  };\n}\n"],"names":["useConfig","componentName","injectGlobalConfig","inject","configProviderInjectKey","mergedGlobalConfig","computed","value","defaultGlobalConfig","globalConfig","classPrefix","t","pattern","args","data","regular","translated","replace","match","key","String","length","h","global"],"mappings":";;;;;;;;;;;;;AAaO,SAASA,UAAgDC,aAAmB,EAAA;AAC3E,EAAA,IAAAC,kBAAA,GAAqBC,MAAO,CAAAC,uBAAA,EAAyB,IAAI,CAAA,CAAA;EAC/D,IAAMC,kBAAqB,GAAAC,QAAA,CAAS,YAAA;IAAA,OAAM,CAAAJ,kBAAA,KAAAA,IAAAA,IAAAA,kBAAA,uBAAAA,kBAAA,CAAoBK,UAASC,mBAAmB,CAAA;GAAA,CAAA,CAAA;EAC1F,IAAMC,YAAe,GAAAH,QAAA,CAAS,YAAA;AAAA,IAAA,OAAMD,kBAAA,CAAmBE,MAAMN,aAAc,CAAA,CAAA;GAAA,CAAA,CAAA;AAErE,EAAA,IAAAS,WAAA,GAAcJ,SAAS,YAAM;AACjC,IAAA,OAAOD,mBAAmBE,KAAM,CAAAG,WAAA,CAAA;AAClC,GAAC,CAAA,CAAA;AAGK,EAAA,IAAAC,CAAA,GAAI,SAAJA,CAAA,CAAiBC,OAAA,EAA4B;AAAA,IAAA,KAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAAbC,IAAa,GAAA,IAAA,KAAA,CAAA,IAAA,GAAA,CAAA,GAAA,IAAA,GAAA,CAAA,GAAA,CAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;MAAbA,IAAa,CAAA,IAAA,GAAA,CAAA,CAAA,GAAA,SAAA,CAAA,IAAA,CAAA,CAAA;AAAA,KAAA;IAC3C,IAACC,IAAI,GAAID,IAAA,CAAA,CAAA,CAAA,CAAA;AACX,IAAA,IAAA,OAAOD,YAAY,QAAU,EAAA;AAC/B,MAAA,IAAI,CAACE,IAAA,EAAa,OAAAF,OAAA,CAAA;MAClB,IAAMG,OAAU,GAAA,qBAAA,CAAA;AAChB,MAAA,IAAMC,aAAaJ,OAAQ,CAAAK,OAAA,CAAQF,OAAS,EAAA,UAACG,OAAOC,GAAQ,EAAA;AAC1D,QAAA,IAAIL,IAAM,EAAA;AACD,UAAA,OAAAM,MAAA,CAAON,KAAKK,GAAI,CAAA,CAAA,CAAA;AACzB,SAAA;AACO,QAAA,OAAA,EAAA,CAAA;AACT,OAAC,CAAA,CAAA;AACM,MAAA,OAAAH,UAAA,CAAA;AACT,KAAA;AACI,IAAA,IAAA,OAAOJ,YAAY,UAAY,EAAA;MAEjC,IAAI,CAACC,IAAK,CAAAQ,MAAA,EAAQ,OAAOT,QAAQU,CAAC,CAAA,CAAA;MAC3B,OAAAV,OAAA,CAAWC,KAAAA,CAAAA,KAAAA,CAAAA,EAAAA,IAAI,CAAA,CAAA;AACxB,KAAA;AACO,IAAA,OAAA,EAAA,CAAA;GACT,CAAA;EAEO,OAAA;AACLF,IAAAA,CAAA,EAAAA,CAAA;AACAY,IAAAA,MAAQ,EAAAd,YAAA;AACRA,IAAAA,YAAA,EAAAA,YAAA;AACAC,IAAAA,WAAA,EAAAA,WAAAA;GACF,CAAA;AACF;;;;"}