{"version":3,"file":"switch.js","sources":["../../src/switch/switch.tsx"],"sourcesContent":["import { defineComponent, h, VNodeChild, computed, watch, toRefs } from 'vue';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport TLoading from '../loading';\nimport props from './props';\nimport { TNodeReturnValue } from '../common';\n\n// hooks\nimport { useFormDisabled } from '../form/hooks';\nimport useVModel from '../hooks/useVModel';\n\nexport default defineComponent({\n  name: 'TSwitch',\n  props: { ...props },\n\n  setup(props, { slots }) {\n    const disabled = useFormDisabled();\n    const COMPONENT_NAME = usePrefixClass('switch');\n    const { STATUS, SIZE } = useCommonClassName();\n    // values\n    const { value, modelValue } = toRefs(props);\n    const [innerValue, setSwitchVal] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n\n    const activeValue = computed(() => {\n      if (props.customValue && props.customValue.length > 0) {\n        return props.customValue[0];\n      }\n      return true;\n    });\n    const inactiveValue = computed(() => {\n      if (props.customValue && props.customValue.length > 1) {\n        return props.customValue[1];\n      }\n      return false;\n    });\n\n    // methods\n    function handleToggle() {\n      const checked = innerValue.value === activeValue.value ? inactiveValue.value : activeValue.value;\n      // emits\n      setSwitchVal(checked);\n    }\n\n    function toggle() {\n      if (disabled.value || props.loading) {\n        return;\n      }\n      handleToggle();\n    }\n\n    // classes\n    const classes = computed(() => [\n      `${COMPONENT_NAME.value}`,\n      SIZE.value[props.size],\n      {\n        [STATUS.value.disabled]: disabled.value,\n        [STATUS.value.loading]: props.loading,\n        [STATUS.value.checked]: innerValue.value === activeValue.value || props.modelValue === activeValue.value,\n      },\n    ]);\n    const nodeClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__handle`,\n        {\n          [STATUS.value.disabled]: disabled.value,\n          [STATUS.value.loading]: props.loading,\n        },\n      ];\n    });\n    const contentClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__content`,\n        SIZE.value[props.size],\n        {\n          [STATUS.value.disabled]: disabled.value,\n        },\n      ];\n    });\n\n    watch(\n      innerValue,\n      (val) => {\n        if (props.customValue && props.customValue.length && !props.customValue.includes(val)) {\n          throw new Error(`value is not in ${JSON.stringify(props.customValue)}`);\n        }\n      },\n      {\n        immediate: true,\n      },\n    );\n\n    const content = computed<VNodeChild>(() => {\n      if (typeof props.label === 'function') {\n        return props.label(h, { value: innerValue.value });\n      }\n      if (typeof props.label === 'string') {\n        return props.label;\n      }\n      if (Array.isArray(props.label) && props.label.length) {\n        const label = innerValue.value === activeValue.value ? props.label[0] : props.label[1];\n        if (!label) return;\n        if (typeof label === 'string') {\n          return label;\n        }\n        if (typeof label === 'function') {\n          return label(h);\n        }\n      }\n      if (slots.label) {\n        return slots.label({ value: innerValue.value });\n      }\n      return null;\n    });\n    return () => {\n      let switchContent: VNodeChild;\n      let loadingContent: TNodeReturnValue;\n      if (props.loading) {\n        loadingContent = <TLoading size=\"small\" />;\n      } else if (content.value) {\n        switchContent = content.value;\n      }\n\n      return (\n        <div class={classes.value} disabled={disabled.value} onClick={toggle}>\n          <span class={nodeClasses.value}>{loadingContent}</span>\n          <div class={contentClasses.value}>{switchContent}</div>\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","slots","disabled","useFormDisabled","COMPONENT_NAME","usePrefixClass","useCommonClassName","STATUS","SIZE","toRefs","value","modelValue","useVModel","defaultValue","onChange","innerValue","setSwitchVal","activeValue","computed","customValue","length","inactiveValue","handleToggle","checked","toggle","loading","classes","size","nodeClasses","contentClasses","watch","val","includes","Error","JSON","stringify","immediate","content","label","h","Array","isArray","switchContent","loadingContent","_createVNode","TLoading"],"mappings":"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"}