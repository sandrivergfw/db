{"version":3,"file":"menu-item.js","sources":["../../src/menu/menu-item.tsx"],"sourcesContent":["import { defineComponent, computed, inject, onMounted, ref, toRefs } from 'vue';\nimport props from './menu-item-props';\nimport { TdMenuInterface, TdSubMenuInterface } from './const';\nimport { renderContent, renderTNodeJSX } from '../utils/render-tnode';\nimport { emitEvent } from '../utils/event';\nimport useRipple from '../hooks/useRipple';\nimport { usePrefixClass } from '../hooks/useConfig';\n\nexport default defineComponent({\n  name: 'TMenuItem',\n  props: { ...props },\n  emits: ['click'],\n  setup(props, ctx) {\n    const { href, target = '_self' } = toRefs(props);\n    const classPrefix = usePrefixClass();\n    const menu = inject<TdMenuInterface>('TdMenu');\n    const itemRef = ref<HTMLElement>();\n    useRipple(itemRef);\n    const submenu = inject<TdSubMenuInterface>('TdSubmenu', null);\n    const active = computed(() => menu.activeValue.value === props.value);\n    const classes = computed(() => [\n      `${classPrefix.value}-menu__item`,\n      {\n        [`${classPrefix.value}-is-active`]: active.value,\n        [`${classPrefix.value}-is-disabled`]: props.disabled,\n        [`${classPrefix.value}-menu__item--plain`]: !ctx.slots.icon && !props.icon,\n        [`${classPrefix.value}-submenu__item`]: !!submenu && !menu.isHead,\n      },\n    ]);\n\n    // lifetimes\n    onMounted(() => {\n      menu?.vMenu?.add({ value: props.value, parent: submenu?.value, vnode: ctx.slots.default });\n    });\n\n    return {\n      classPrefix,\n      menu,\n      active,\n      classes,\n      itemRef,\n      href,\n      target,\n    };\n  },\n  methods: {\n    handleClick(e: MouseEvent) {\n      e.stopPropagation();\n      if (this.disabled) return;\n      this.menu.select(this.value);\n      emitEvent(this, 'click');\n      if (this.to) {\n        const router = this.router || this.$router;\n        const methods: string = this.replace ? 'replace' : 'push';\n        router[methods](this.to).catch((err: Error) => {\n          // vue-router 3.1.0+ push/replace cause NavigationDuplicated error\n          // https://github.com/vuejs/vue-router/issues/2872\n          // 当前path和目标path相同时，会抛出NavigationDuplicated的错误\n          if (\n            err.name !== 'NavigationDuplicated' &&\n            !err.message.includes('Avoided redundant navigation to current location')\n          ) {\n            throw err;\n          }\n        });\n      }\n    },\n  },\n  render() {\n    return (\n      <li ref=\"itemRef\" class={this.classes} onClick={this.handleClick}>\n        {renderTNodeJSX(this, 'icon')}\n        {this.href ? (\n          <a href={this.href} target={this.target} className={`${this.classPrefix}-menu__item-link`}>\n            <span className={`${this.classPrefix}-menu__content`}>{renderContent(this, 'default', 'content')}</span>\n          </a>\n        ) : (\n          <span class={[`${this.classPrefix}-menu__content`]}>{renderContent(this, 'default', 'content')}</span>\n        )}\n      </li>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","emits","setup","ctx","toRefs","href","target","classPrefix","usePrefixClass","menu","inject","itemRef","ref","useRipple","submenu","active","computed","activeValue","value","classes","disabled","slots","icon","isHead","onMounted","vMenu","add","parent","vnode","methods","handleClick","e","stopPropagation","select","emitEvent","to","router","$router","replace","err","message","includes","render","_createVNode","renderTNodeJSX","renderContent"],"mappings":"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"}